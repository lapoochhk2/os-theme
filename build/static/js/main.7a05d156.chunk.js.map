{"version":3,"sources":["helpers/locales sync /^/.//.*/.json$","helpers/actions.js","helpers/AttributesHelper.js","components/NavBar/index.js","components/Footer/index.js","components/widgets/Seperator/index.js","components/widgets/Banner/index.js","components/widgets/Product/index.js","components/widgets/ArticleTile/index.js","components/widgets/CollectionProduct/index.js","components/widgets/index.js","scenes/Home/index.js","scenes/Product/index.js","scenes/Product/Detail/index.js","scenes/Blog/index.js","scenes/Blog/Detail/index.js","scenes/404/index.js","helpers/formValidator.js","scenes/Checkout/index.js","helpers/websocket.js","scenes/User/Profile/index.js","scenes/User/index.js","scenes/User/Register/index.js","scenes/User/Login/index.js","scenes/User/Recovery/index.js","scenes/Cart/index.js","scenes/Checkout/OrderSnapshot/index.js","scenes/Page/index.js","components/Chat/chatRow.js","components/Chat/index.js","scenes/Routes/index.js","scenes/App/index.js","serviceWorker.js","helpers/reducers/product.js","helpers/reducers/article.js","helpers/reducers/user.js","helpers/reducers/shop.js","helpers/reducers/cart.js","helpers/reducers/home.js","helpers/reducers/i18n.js","helpers/reducers/index.js","index.js","config.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","doExtract","value","matches","exec","length","zh_hk","en_us","captureWithLocale","locale","toLowerCase","extractByLocaleCode","shop","attributes","reduce","cusTitles","key","forEach","l","connect","state","session","settings","cart","i18n","dispatch","setLocale","type","actions","payload","props","location","useLocation","useState","hasShadow","setHasShadow","navBarExpanded","setNavBarExpanded","localeMenuExpanded","setLocaleMenuExpanded","__","locales","customizeTitles","navBarSettings","layout","navBar","display","blog","user","useEffect","window","onscroll","pageYOffset","className","style","boxShadow","border","to","logo","src","name","fontWeight","pathname","nav_home","startsWith","nav_blog","nav_shop","onClick","items","count","item","parseInt","qty","description","fontawesomeMap","facebook","instagram","twitter","youtube","pinterest","filter","s","undefined","test","href","target","Date","getFullYear","Separator","width","height","backgroundColor","styles","ownProps","homeContext","home","setHomeContext","isLoading","setIsLoading","OS","Oneshop","articleInfoExtractor","article","title","sections","thumbnail","media","url","filters","ordering","tags","keywords","ids","collections","get","then","rows","catch","error","alert","fetchArticles","properties","duration","transitionDuration","infinite","indicators","arrows","a","idx","backgroundImage","renderSlider","alignItems","justifyContent","size","color","loading","layout_override","index","attribute_settings","customizeTitle","productInfoExtractor","product","variants","v","price","merchandise","fetchProducts","cols","gap","loop","p","Item","substr","currency","toUpperCase","prices","i","indexOf","Math","min","max","replace","Banner","Product","Seperator","ArticleTile","CollectionProduct","fetch","res","json","data","r","join","content","widgetSettings","Widget","widget","widgets","products","selectedCollection","setProducts","setCollections","setSelectedCollection","collectionId","endOfList","setEndOfList","status","setStatus","toggleLoading","params","page","ceil","isNaN","concat","console","extractThumbnail","thumbnail_url","variantsHasThumbnails","oldStatus","newStatus","async","method","fetchCollections","placeholder","onChange","option","options","c","label","padding","setCartItems","useParams","setProduct","setVariants","addingToCart","setQty","redirect","setRedirect","selectedVariant","setSelectedVariant","setLoading","selectOption","selectedOption","selectedValue","oldVariants","newVariants","valueName","oldSelectedVariant","newSelectedVariant","getSelectedVariant","targetVariant","desc","identical","split","optionSet","assign","optionName","optionValue","qtyButtonOnClick","increament","_qty","stock","selectedVariantObj","urls","m","push","renderSlides","toFixed","HTMLParser","t","valuesOfFirstOption","values","renderVariants","shouldDisabled","disabled","renderQtySelector","variant_id","put","articles","setArticles","thumbnailExtractor","sectionHasMedia","captionExtractor","section","time","toLocaleDateString","setArticle","parseHTML","NotFound","validate","path","form","rule","findRuleByPath","getValueAtObjectByPath","getFieldError","rules","contact","first_name","field_name","regex","required","last_name","email","phone","payment","card","csc","exp_date","coupons","shipping","address","country","drill","paths","obj","shift","prototype","toString","call","deleteValueAtObjectByPath","pop","setValueAtObjectByPath","_obj","field","assignHandler","prop","RegExp","countryEscape","countriesNeedExtraInfo","step","setStep","shippingMethods","setShippingMethods","preview","setPreview","paid","setPaid","shippings","notes","setForm","extraInfo","setExtraInfo","formErrors","setFormErrors","countries","getCodeList","makePayment","trim","JSON","stringify","slice","consumer","checkout","order","place","Array","isArray","message","setFormValue","oldForm","newForm","getFormErrorView","error_msg","validateField","oldFormErrors","newFormErrors","isFormValid","isValid","renderStep","onBlur","shipping_methods","customShippings","_country","exclude_countries","charge","address_required","shipping_address_required","auto_ship","body","autoShippings","rates","loadShippingMethods","maxLength","previewForm","messages","previewOrder","match","sub_total","total","shipping_fee","breakdowns","discounts","d","data-tip","substring","amount","gross_total","cookies","Cookies","endpoint","ws","getProtocol","protocol","uuid","set","samesite","secure","now","performance","random","floor","getClient","cb","WebSocket","retryTimer","respawnTimer","isConnecting","commands","broadcastListeners","connectionListeners","keepConnectionAlive","setTimeout","readyState","OPEN","send","reconnect","intervalInSeconds","onopen","log","clearTimeout","attachMethods","setAction","action","setArguments","args","arguments","setMethod","cmd","handler","idCallback","getBroadCastListener","identifier","registerBroadCastListener","listener","removeBroadCastListener","getConnectionListeners","registerConnectionListeners","removeConnectionListeners","onmessage","msg","result","parse","broadcast","onclose","onerror","clearProtocol","remove","close","profile","setProfile","updateFormData","formChanged","hasChanges","update","logout","Profile","setEmail","password","setPassword","confirmPassword","setConfirmPassword","firstName","setFirstName","lastName","setLastName","isRegistered","setIsRegistered","event","signUp","passwd","confpasswd","Promise","all","login","reject","shopId","setType","isResetPass","textDecoration","confPassword","validation","create","consume","row","removeItem","itemId","refreshCart","editItemQty","alt","variant","initCart","cartId","resetCart","discounted_amount","html","fileName","file","text","setText","fetchFile","parser","toAmPm","timestring","hh","getHours","h","M","getMinutes","attachments","created_time","sender","previousItem","nextItem","msgStatusDidChangeAtRowIndex","placeToLeft","paddingTop","paddingBottom","attachment","client","setClient","setPercentage","uploadAttachment","sendMessage","sendMessageHandler","extension","signatureHandler","uploadPhoto","signature","FormData","append","bucketAcl","mimeType","amzCred","expDate","encodedPolicy","sign","xhr","XMLHttpRequest","open","upload","onprogress","loaded","onload","endPoint","globalProfile","showChatBox","setShowChatBox","setMessages","inputVal","setInputVal","setAttachment","setThumbnail","getProfile","getMessages","onBroadcast","scrollToEnd","msgsList","document","getElementById","scrollTop","scrollHeight","context","shop_id","oldMsgs","getProfileHandler","newMsgs","toISOString","getMessagesHandler","valid","isMobile","innerWidth","innerHeight","borderRadius","zIndex","borderColor","flex","ms","sort","b","getTime","arr","click","hidden","accept","files","reader","FileReader","readAsDataURL","onKeyUp","keyCode","withRouter","NavBar","component","Home","exact","ProductDetail","Blog","BlogDetail","Page","User","Register","Login","AccountRecovery","from","Checkout","OrderSnapshot","Cart","setShop","oneshop","setupCart","getShop","cart_items","validateCart","Boolean","hostname","initState","best_sellers","require","default","wordings","combineReducers","home_page_layout","OS_Config","reload","store","createStore","reducer","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister","numberToShow","margin","collection_tags","links","policies","shipping_policy","privacy_policy","terms_and_conditions","social"],"mappings":"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","file":"static/js/main.7a05d156.chunk.js","sourcesContent":["var map = {\n\t\"./en_US.json\": 225,\n\t\"./zh_HK.json\": 226\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 224;","export default {\n    SET_SHOP         : 'SET_SHOP',\n    SET_USER         : 'SET_USER',\n    SET_PRODUCTS     : 'SET_PRODUCTS',\n    ADD_BEST_SELLERS : 'ADD_BEST_SELLERS',\n    SET_ARTICLES     : 'SET_ARTICLES'   ,\n    INIT_CART        : 'INIT_CART',\n    SET_CART_ITEMS   : 'SET_CART_ITEMS',\n    SET_HOME_CONTEXT : 'SET_HOME_CONTEXT',\n    SET_LOCALE       : 'SET_LOCALE',\n    SET_COLLECTIONS  : 'SET_COLLECTIONS',\n    SET_SELECTED_COLLECTION : 'SET_SELECTED_COLLECTION'\n}","const doExtract = (value) => {\n    // try to match pattern\n    let matches = /^zh_hk:([a-zA-Z0-9 \\u4E00-\\u9FFF\\u3400-\\u4DBF]+)\\|en_us:([a-zA-Z0-9 \\u4E00-\\u9FFF\\u3400-\\u4DBF]+)$/.exec(value)\n    // return string with locale key if has matches\n    return (matches || []).length > 2 ? {\n        zh_hk : matches[1],\n        en_us : matches[2]\n    } : null\n}\n\nexport const captureWithLocale = ({ locale, value }) => (doExtract(value) || {})[locale.toLowerCase()]\n\nexport const extractByLocaleCode = ({ locale, shop, keys = ['nav_home', 'nav_blog', 'nav_shop'] }) => {\n    // get shop attributes\n    const { attributes } = shop;\n    // special nav bar title?\n    const customizeTitles = keys.reduce((cusTitles, key) => {\n        // get value of custom title\n        let value = attributes[key]\n        // match strings\n        let matches = doExtract(value || \"\")\n        // has value and fullfil the format\n        if(matches !== null){\n            // append value\n            ['en_us', 'zh_hk'].forEach(l => {\n                cusTitles[l] = cusTitles[l] || {}\n                cusTitles[l][key] = matches[l]    \n            });\n        }\n        return cusTitles;\n    }, {})\n    return customizeTitles[locale.toLowerCase()] || {};\n}","import React, { useState, useEffect } from 'react';\nimport { useLocation, Link } from 'react-router-dom';\nimport './navBar.css';\nimport actions from '../../helpers/actions';\nimport { connect } from 'react-redux';\nimport { extractByLocaleCode } from '../../helpers/AttributesHelper';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    shop     : state.shop.session,\n    settings : state.shop.settings,\n    cart     : state.cart,\n    i18n     : state.i18n\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setLocale : (locale) => dispatch({\n        type    : actions.SET_LOCALE,\n        payload : locale\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction NarBar(props){\n\n    // get window href\n    let location = useLocation();\n    // navBar style override state\n    let [hasShadow, setHasShadow] = useState(false);\n    // expand status\n    let [navBarExpanded, setNavBarExpanded] = useState(false);\n    // local menu expanded\n    let [localeMenuExpanded, setLocaleMenuExpanded] = useState(false);\n    // get shop\n    const { shop, cart, settings } = props;\n    // get translation helpers\n    const { locale, __, locales } = props.i18n;\n\n    // special nav bar title?\n    const customizeTitles = extractByLocaleCode({\n        locale, shop\n    });\n\n    // preset settings\n    let navBarSettings = ((settings || {}).layout || {}).navBar || {\n        display : {\n            blog : true,\n            shop : true,\n            user : true\n        }\n    };\n\n    // ---------------- LIFECYCLE ----------------\n    useEffect(() => {\n        // scroll listener\n        window.onscroll = function() {\n            setHasShadow(window.pageYOffset > 69);\n        };\n        // remove listener\n        return () => { window.onscroll = null; };\n    }, []);\n    // ---------------- /LIFECYCLE ----------------\n\n    return (\n        <div className=\"navBar\" style={{ \n            boxShadow : hasShadow ? \"0px 1px 8px #dddddd\" : \"none\",\n            border : \"0.5px solid #dddddd\"\n        }}>\n\n            {/* ------------------ Desktop Nav Bar -----------------*/}\n            <div className=\"navBar-wrapper\">\n                <div className=\"navBar-item title\">\n                    <Link to='/'>\n                        {shop.logo.length > 0 ? <img className=\"logo\" src={shop.logo} /> : null}\n                        <h2>{shop.name}</h2>\n                    </Link>\n                </div>\n                <div className=\"navBar-item\">\n                    <Link to='/' style={{fontWeight:location.pathname === \"/\" ? 500 : 300}}>\n                        {customizeTitles.nav_home || __(\"Home\")}\n                    </Link>\n                </div>\n                {\n                    navBarSettings && (navBarSettings.display || {}).blog === true ?\n                    <div className=\"navBar-item\">\n                        <Link to='/blogs' style={{fontWeight:location.pathname.startsWith(\"/blogs\") ? 500 : 300}}>\n                            {customizeTitles.nav_blog || __(\"Blog\")}\n                        </Link>\n                    </div> : null\n                }\n                {\n                    navBarSettings && (navBarSettings.display || {}).shop === true ?\n                    <div className=\"navBar-item\">\n                        <Link to='/products' style={{fontWeight:location.pathname.startsWith(\"/products\") ? 500 : 300}}>\n                            {customizeTitles.nav_shop || __(\"Shop\")}\n                        </Link>\n                    </div> : null\n                }\n                <div className=\"navBar-item\">\n                    <button onClick={() => setLocaleMenuExpanded(!localeMenuExpanded)}>\n                        <i className=\"fas fa-globe-asia\"></i>\n                    </button>\n                    <div className={`locale-menu ${localeMenuExpanded ? \"expanded\" : \"\"}`}>\n                        {locales.map(l => (\n                            <button key={`lang-${l.code}`} className=\"locale-btn\" onClick={() => {\n                                // set locale\n                                props.setLocale(l.code);\n                                // close menu\n                                setLocaleMenuExpanded(false);\n                            }}>\n                                {locale == l.code ? <b>{l.name}</b> : l.name}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n                {\n                    navBarSettings && (navBarSettings.display || {}).shop === true ?\n                    <div className=\"navBar-item\">\n                        <Link to='/cart'>\n                            {\n                                cart.items.length > 0 ?\n                                <span className=\"count\">\n                                    {cart.items.reduce((count, item) => count + parseInt(item.qty), 0)}\n                                </span> : null\n                            }\n                            <i className=\"fas fa-shopping-cart\"></i>\n                        </Link>\n                    </div> : null\n                }\n                {\n                    navBarSettings && (navBarSettings.display || {}).user === true ?\n                    <div className=\"navBar-item\">\n                        <Link to='/users'>\n                            <i className=\"fas fa-user\"></i>\n                        </Link>\n                    </div> : null\n                }\n            </div>\n            {/* ------------------ /Desktop Nav Bar -----------------*/}\n\n\n            {/* ------------------ Mobile Nav Bar -----------------*/}\n            <div className=\"navBar-wrapper-mobile\">\n                <div className=\"top-body\">\n                    <button className=\"expand-btn\" onClick={() => setNavBarExpanded(!navBarExpanded)}>\n                        {navBarExpanded ? <i className=\"fas fa-times\"></i> : <i className=\"fas fa-bars\"></i>}\n                    </button>\n                    <div className=\"navBar-item title\">\n                        {shop.logo.length > 0 ? <img className=\"logo\" src={shop.logo} /> : null}\n                        <h2>{shop.name}</h2>\n                    </div>\n                    <div className=\"fast-link\">\n                        <Link to='/cart' onClick={() => setNavBarExpanded(false)}>\n                            {\n                                cart.items.length > 0 ?\n                                <span className=\"count\">\n                                    {cart.items.reduce((count, item) => count + parseInt(item.qty), 0)}\n                                </span> : null\n                            }\n                            <i className=\"fas fa-shopping-cart\"></i>\n                        </Link>\n                    </div>\n                    <div className=\"fast-link\">\n                        <Link to='/users' onClick={() => setNavBarExpanded(false)}>\n                            <i className=\"fas fa-user\"></i>\n                        </Link>\n                    </div>\n                </div>\n                {/* ------------ Expandable list ------------ */}\n                <div className={`navBar-item-list ${navBarExpanded ? \"expand\" : \"\"}`}>\n                    <div className=\"navBar-item\">\n                        <Link to='/' style={{fontWeight:location.pathname === \"/\" ? 500 : 300}} onClick={() => setNavBarExpanded(false)}>\n                            {customizeTitles.nav_home || __(\"Home\")}\n                        </Link>\n                    </div>\n                    <div className=\"navBar-item\">\n                        <Link to='/blogs' style={{fontWeight:location.pathname.startsWith(\"/blogs\") ? 500 : 300}} onClick={() => setNavBarExpanded(false)}>\n                            {customizeTitles.nav_blog || __(\"Blog\")}\n                        </Link>\n                    </div>\n                    <div className=\"navBar-item\">\n                        <Link to='/products' style={{fontWeight:location.pathname.startsWith(\"/products\") ? 500 : 300}} onClick={() => setNavBarExpanded(false)}>\n                            {customizeTitles.nav_shop || __(\"Shop\")}\n                        </Link>\n                    </div>\n                    <div className=\"navBar-item\">\n                        <div className={`locale-menu expanded`}>\n                            {locales.map(l => (\n                                <button key={`lang-${l.code}`} className=\"locale-btn\" onClick={() => {\n                                    // set locale\n                                    props.setLocale(l.code);\n                                    // close menu\n                                    setLocaleMenuExpanded(false);\n                                }}>\n                                    {locale == l.code ? <b>{l.name}</b> : l.name}\n                                </button>\n                            ))}\n                        </div>\n                    </div>\n                </div>\n                {/* ------------ Expandable list ------------ */}\n            </div>\n            {/* ------------------/ Mobile Nav Bar -----------------*/}\n\n        </div>\n    )\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NarBar);","import React from 'react';\nimport {  Link } from 'react-router-dom';\nimport './footer.css';\nimport { connect } from 'react-redux';\nimport { extractByLocaleCode } from '../../helpers/AttributesHelper';\n\n\nconst mapStateToProps = state => ({\n    shop: state.shop.session,\n    settings : state.shop.settings,\n    i18n : state.i18n\n});\n\n\nfunction Footer(props){\n\n    // get shop\n    const { shop } = props;\n    // get i18n settings\n    const { __, locale } = props.i18n;\n    // get shop attributes\n    const { attributes } = shop;\n    // special footer titles\n    const customizeTitles = extractByLocaleCode({\n        locale, shop\n    });\n    \n    return <div className=\"footer\">\n        <div className=\"cols\">\n            <div className=\"col shop\">\n                <div className=\"shop-title\">\n                    {shop.name}\n                </div>\n                <div className=\"shop-desc\">\n                    {shop.description}\n                </div>\n            </div>\n            <div className=\"col links\">\n                <Link to=\"/\">\n                    {customizeTitles.nav_home || __(\"Home\")}\n                </Link>\n                <Link to=\"/blogs\">\n                    {customizeTitles.nav_blog ||__(\"Blog\")}\n                </Link>\n                <Link to=\"/products\">\n                    {customizeTitles.nav_shop ||__(\"Shop\")}\n                </Link>\n                <Link to=\"/cart\">\n                    {__(\"Cart\")}\n                </Link>\n                <Link to=\"/users\">\n                    {__(\"My Account\")}\n                </Link>\n            </div>\n            <div className=\"col links\">\n                <Link to=\"/pages/terms_and_conditions\">\n                    {__(\"Terms and Conditions\")}\n                </Link>\n                <Link to=\"/pages/privacy_policy\">\n                    {__(\"Privacy Policy\")}\n                </Link>\n                <Link to=\"/pages/shipping_policy\">\n                    {__(\"Shipping Policy\")}\n                </Link>\n            </div>\n            <div className=\"col links social\">\n                {(() => {\n                    const fontawesomeMap = {\n                        facebook  : \"fab fa-facebook\",\n                        instagram : \"fab fa-instagram\",\n                        twitter   : \"fab fa-twitter\",\n                        youtube   : \"fab fa-youtube\",\n                        pinterest : \"fab fa-pinterest\"\n                    };\n                    return Object.keys(fontawesomeMap)\n                            .filter(s => attributes[s] !== undefined && /^https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)$/i.test(attributes[s]))\n                            .map(s => (\n                                <a key={`footer-social-link-${s}`} href={attributes[s]} target=\"_blank\">\n                                    <i className={fontawesomeMap[s]}></i>\n                                </a>\n                            ));\n                })()}\n            </div>\n        </div>\n        <div className=\"copyright\">\n            <div>Copyright@{new Date().getFullYear()} {shop.name}.</div>\n            <div className=\"powered-by\"> \n                <a href=\"https://oneshop.cloud\">\n                    <img src=\"/assets/images/oneshop_logo.png\"/> Powered by Oneshop.\n                </a>\n            </div>\n        </div>\n    </div>\n\n}\n\nexport default connect(mapStateToProps)(Footer);","import React from 'react';\n\nfunction Separator(props) {\n    return <div id={props.id} \n                style={{ \n                    width : \"100%\", \n                    height : 1, \n                    backgroundColor : \"#dfdfdf\", \n                    ...props.styles\n            }}></div>;\n}\n\nexport default Separator;","import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport actions from '../../../helpers/actions';\nimport './widget.banner.css';\nimport Oneshop from 'oneshop.web';\nimport { MoonLoader } from 'react-spinners';\nimport { Slide } from 'react-slideshow-image';\n\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = (state, ownProps) => ({\n    homeContext : state.home,\n    i18n        : state.i18n,\n    ...ownProps\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    setHomeContext : (key, payload) => dispatch({\n        type    : actions.SET_HOME_CONTEXT,\n        payload : payload,\n        key\n    }),\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Banner(props){\n\n    // get cached\n    const { setHomeContext, homeContext, id } = props;\n    // set status\n    let [isLoading, setIsLoading] = useState(false);\n    // get oneshop instance\n    const OS = new Oneshop();\n    // get i18n settings\n    let { locale } = props.i18n;\n\n    // ---------------- LIFECYCLE ----------------\n    useEffect(() => {\n        // not fetch yet?\n        if(!homeContext[id]) fetchArticles();\n    }, []);\n\n    function fetchArticles(){\n        // set filters container\n        let filters = {};\n        // filters\n        if((props.ordering || \"\").length > 0) filters.ordering = props.ordering;\n        if((props.tags || \"\").length > 0) filters.tags = props.tags;\n        if((props.keywords || \"\").length > 0) filters.keywords = props.keywords;\n        if((props.ids || \"\").length > 0) filters.ids = props.ids;\n        if((props.collections || \"\").length > 0) filters.collections = props.collections;\n        // start loading\n        setIsLoading(false);\n        // get articles\n        OS.article.get({\n            ...filters,\n            locale\n        })\n        // got articles\n        .then(rows => {\n            // finished loading\n            setIsLoading(false);\n            // save context\n            if(rows.length) setHomeContext(id, rows);\n        })\n        // error\n        .catch(error => {\n            // finished loading\n            setIsLoading(false);\n            // show error\n            alert(\"Failed to get featured article\");\n        });\n    }\n    // ---------------- /LIFECYCLE ----------------\n    \n\n    // ---------------- RENDERING ----------------\n    function renderSlider(){\n        // define properties\n        const properties = {\n           duration : props.duration != undefined ? props.duration : 5000,\n           transitionDuration : props.transitionDuration != undefined ? props.transitionDuration : 300,\n           infinite : props.infinite != undefined ? props.infinite : false,\n           indicators : props.indicators != undefined ? props.indicators : true,\n           arrows : props.arrows != undefined ? props.arrows : true\n       };\n       return <Slide {...properties}>\n            {(homeContext[id] || []).map((a, idx) => (\n                <Link key={`slide-image-${idx}`} to={`/blogs/${a.id}`}>\n                    <div className=\"each-slide\">\n                        <div style={{ backgroundImage : `url(${articleInfoExtractor(a).thumbnail})`}}>\n                            <h1>{articleInfoExtractor(a).title}</h1>\n                        </div>\n                    </div>\n                </Link>\n            ))}\n        </Slide>;\n    }\n\n    function articleInfoExtractor(article){\n        // set thumbnail\n        return {\n            title     : ((article.sections || [])[0] || {}).title || \"\",\n            thumbnail : (((((article.sections || []).filter(s => s.media.length > 0) || [])[0] || {}).media || [])[0] || {}).url || \"\"\n        }\n    }\n    // ---------------- /RENDERING ----------------\n\n    // banner data loaded?\n    return homeContext[id] && !isLoading ? <div className=\"widget-banner\" style={{...props.styles}}>\n        {renderSlider()}\n    </div> : \n    isLoading ?\n    <div style={{ width : \"100%\", height : 500, display:\"flex\", alignItems : \"center\", justifyContent : \"center\" }}>\n        <MoonLoader \n            size={20}\n            color={\"#000000\"}\n            loading={true}\n        />\n    </div> : null;\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Banner);","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport actions from '../../../helpers/actions';\nimport './widget.product.css';\nimport Oneshop from 'oneshop.web';\nimport { MoonLoader } from 'react-spinners';\nimport Carousel from 'react-grid-carousel'\nimport { captureWithLocale } from '../../../helpers/AttributesHelper';\n\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = (state, ownProps) => ({\n    homeContext : state.home,\n    shop        : state.shop.session,\n    i18n        : state.i18n,\n    settings    : state.shop.settings,\n    ...ownProps\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    setHomeContext : (key, payload) => dispatch({\n        type    : actions.SET_HOME_CONTEXT,\n        payload : payload,\n        key\n    }),\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Product(props){\n\n    // get cached\n    const { setHomeContext, homeContext, id, shop, settings : { layout_override }, index } = props;\n    // get translation method\n    const { __, locale } = props.i18n;\n    // set loading status\n    let [isLoading, setIsLoading] = useState(false);\n    // get oneshop instance\n    const OS = new Oneshop();\n    // get settings from attributes\n    const attribute_settings = layout_override[index] || {}\n    // special nav bar title?\n    const customizeTitle = captureWithLocale({\n        locale,\n        value : attribute_settings.title\n    })\n\n    // ---------------- LIFECYCLE ----------------\n    useEffect(() => {\n        // not fetch yet?\n        if(!homeContext[id]) fetchProducts();\n    }, []);\n\n    function fetchProducts(){\n        // set filters container\n        let filters = {};\n        // filters\n        if((props.ordering || \"\").length > 0) filters.ordering = props.ordering;\n        if((props.tags || \"\").length > 0) filters.tags = props.tags;\n        if((props.keywords || \"\").length > 0) filters.keywords = props.keywords;\n        if((props.ids || \"\").length > 0) filters.ids = props.ids;\n        if((props.collections || \"\").length > 0) filters.collections = props.collections;\n        // start loading\n        setIsLoading(true);\n        // get \n        OS.merchandise.get({\n            ...filters,\n            locale\n        })\n        // got products\n        .then(rows => {\n            // finished loading\n            setIsLoading(false);\n            // save context\n            if(rows.length > 0) setHomeContext(id, rows);\n        })\n        // error\n        .catch(error => {\n            // finished loading\n            setIsLoading(false);\n            // show alert\n            alert(\"Failed to get products\");\n        });\n    }\n    // ---------------- /LIFECYCLE ----------------\n    \n    // ---------------- RENDERING ----------------\n    function renderSlider(){\n        return <Carousel cols={props.cols || 5} rows={props.rows || 1} gap={15} loop>\n            {(homeContext[id] || []).map((p, idx) => (\n                <Carousel.Item key={`slide-image-${idx}`} >\n                    <Link to={`/products/${p.id}`}>\n                        <div className=\"product-grid\">\n                            <img src={productInfoExtractor(p).thumbnail} />\n                            <div className=\"title\">{productInfoExtractor(p).title.substr(0, 40)}{productInfoExtractor(p).title.length > 40 ? \"...\" : \"\"}</div>\n                            <div className=\"price\">\n                                {function(){\n                                    // get currency\n                                    const currency = shop.currency.toUpperCase();\n                                    // get all prices\n                                    let prices = p.variants.map(v => (v.price || 0))\n                                        // get value larger then 0 only\n                                        .filter(p => p > 0)\n                                        // filter duplicate\n                                        .filter((v, i, a) => a.indexOf(v) === i)\n                                    // only one value\n                                    if(prices.length === 0) {\n                                        return `${currency} ${p.price || 0}`\n                                    } else if(prices.length < 2) {\n                                        return `${currency} ${prices[0] || 0}`\n                                    } else {\n                                        return `${currency} ${Math.min(...prices)} - HKD ${Math.max(...prices)}`\n                                    }\n                                }()}\n                            </div>\n                        </div>\n                    </Link>\n                </Carousel.Item>\n            ))}\n        </Carousel>;\n   }\n\n   function productInfoExtractor(product){\n        // set thumbnail\n        return {\n            title     : (product || {}).name || \"\",\n            thumbnail : (((((product.variants || []).filter(v => v.media.length > 0) || [])[0] || {}).media || [])[0] || {}).url || \"\",\n            price     : (product || {}).price || 0\n        }\n   }\n   // ---------------- /RENDERING ----------------\n\n    // product data loaded?\n    return homeContext[id] && !isLoading ? <div className=\"widget-product\" style={{...props.styles}}>\n        <h1>{customizeTitle || __(props.title)}</h1>\n        {renderSlider()}\n    </div> : \n    isLoading ? \n    <div style={{ width:\"100%\", height:500, display:\"flex\", alignItems:\"center\", justifyContent:\"center\" }}>\n        <MoonLoader \n            size={20}\n            color={\"#000000\"}\n            loading={true}\n        />\n    </div> : null;\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Product);","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport actions from '../../../helpers/actions';\nimport './widget.article.tile.css';\nimport Oneshop from 'oneshop.web';\nimport { MoonLoader } from 'react-spinners';\nimport Carousel from 'react-grid-carousel';\nimport { captureWithLocale } from '../../../helpers/AttributesHelper';\n \n// ------------------------ REDUX ------------------------\nconst mapStateToProps = (state, ownProps) => ({\n    homeContext : state.home,\n    i18n        : state.i18n,\n    settings    : state.shop.settings,\n    ...ownProps\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    setHomeContext : (key, payload) => dispatch({\n        type    : actions.SET_HOME_CONTEXT,\n        payload : payload,\n        key\n    }),\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Article(props){\n\n    // get cache\n    const { setHomeContext, homeContext, id, settings : { layout_override }, index } = props;\n    // get translation method\n    const { __, locale } = props.i18n;\n    // set status\n    let [isLoading, setIsLoading] = useState(false);\n    // get oneshop instance\n    const OS = new Oneshop();\n    // get settings from attributes\n    const attribute_settings = layout_override[index] || {}\n    // special nav bar title?\n    const customizeTitle = captureWithLocale({\n        locale,\n        value : attribute_settings.title\n    })\n\n    // ---------------- LIFECYCLE ----------------\n    useEffect(() => {\n        // not fetch yet?\n        if(!homeContext[id]) fetchArticles();\n    }, []);\n\n    function fetchArticles(){\n        // get settings from config.js\n        const { ordering, tags, keywords, ids, collections } = props;\n        // set filters container\n        let filters = {};\n        // filters\n        if((ordering || \"\").length > 0) filters.ordering = ordering;\n        if((tags || \"\").length > 0) filters.tags = tags;\n        if((keywords || \"\").length > 0) filters.keywords = keywords;\n        if((ids || \"\").length > 0) filters.ids = ids;\n        if((collections || \"\").length > 0) filters.collections = collections;\n        // start loading\n        setIsLoading(true);\n        // get \n        OS.article.get({\n            ...filters,\n            locale\n        })\n        // got articles\n        .then(rows => {\n            // finished loadling\n            setIsLoading(false);\n            // save context\n            if(rows.length > 0) setHomeContext(id, rows);\n        })\n        // error\n        .catch(error => {\n            // finished loadling\n            setIsLoading(false);\n            // show alert\n            alert(\"Failed to get articles\");\n        });\n    }\n    // ---------------- /LIFECYCLE ----------------\n    \n    // ---------------- RENDERING ----------------\n    function renderSlider(){\n       return <Carousel cols={props.cols || 2} rows={props.rows || 2} gap={15} loop>\n            {(homeContext[id] || []).map((a, idx) => (\n                <Carousel.Item  key={`slide-image-${idx}`}>\n                    <Link to={`/blogs/${a.id}`}>\n                        <div className=\"article-grid\">\n                            <div className=\"thumb\">\n                                <img src={articleInfoExtractor(a).thumbnail} />\n                            </div>\n                            <div className=\"title\">{articleInfoExtractor(a).title}</div>\n                            <div className=\"desc\">{articleInfoExtractor(a).description.replace(/<[^>]*>?/gm, '').substr(0, 70) + \"...\"}</div>\n                        </div>\n                    </Link>\n                </Carousel.Item>\n            ))}\n        </Carousel>;\n   }\n\n   function articleInfoExtractor(article){\n        // set thumbnail\n        return {\n            title       : ((article.sections || [])[0] || {}).title || \"\",\n            description : ((article.sections || [])[0] || {}).description || \"\",\n            thumbnail   : (((((article.sections || []).filter(s => s.media.length > 0) || [])[0] || {}).media || [])[0] || {}).url || \"\"\n        }\n    }\n   // ---------------- /RENDERING ----------------\n\n    // article data loaded?\n    return homeContext[id] && !isLoading ? <div className=\"widget-article\" style={{...props.styles}}>\n        <h1>{customizeTitle || __(props.title)}</h1>\n        {renderSlider()}\n    </div> : \n    isLoading ? \n    <div style={{ width:\"100%\", height:500, display:\"flex\", alignItems:\"center\", justifyContent:\"center\" }}>\n        <MoonLoader \n            size={20}\n            color={\"#000000\"}\n            loading={true}\n        />\n    </div> : null;\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Article);","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport actions from '../../../helpers/actions';\nimport './widget.bestseller.css';\nimport Oneshop from 'oneshop.web';\nimport { MoonLoader } from 'react-spinners';\nimport Carousel from 'react-grid-carousel'\nimport { captureWithLocale } from '../../../helpers/AttributesHelper';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = (state, ownProps) => ({\n    homeContext : state.home,\n    shop        : state.shop.session,\n    settings    : state.shop.settings,\n    i18n        : state.i18n,\n    ...ownProps\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n    setHomeContext : (key, payload) => dispatch({\n        type    : actions.SET_HOME_CONTEXT,\n        payload : payload,\n        key\n    }),\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Product(props){\n\n    // get cached\n    const { setHomeContext, homeContext, id, shop, settings : { layout_override }, index } = props;\n    // get translation method\n    const { __, locale } = props.i18n;\n    // set loading status\n    let [isLoading, setIsLoading] = useState(false);\n    // get oneshop instance\n    const OS = new Oneshop();\n    // get settings from attributes\n    const attribute_settings = layout_override[index] || {}\n    // special nav bar title?\n    const customizeTitle = captureWithLocale({\n        locale,\n        value : attribute_settings.title\n    })\n\n    // ---------------- LIFECYCLE ----------------\n    useEffect(() => {\n        // not fetch yet?\n        if(!homeContext[id]) fetchProducts();\n    }, []);\n\n    function fetchProducts(){\n        // fetch bestseller\n        fetch(`/api/collections?tags=${props.tags}`)\n        // got collections\n        .then(res => res.json())\n        // parse json\n        .then(res => {\n            // has collections?\n            if(res.data.rows.length > 0) {\n                // get merchandise\n                OS.merchandise.get({ \n                    collections : res.data.rows.map(r => r.id).join(\",\"),\n                    locale\n                })\n                // got products\n                .then(rows => {\n                    // finished loading\n                    setIsLoading(false);\n                    // save context\n                    if(rows.length > 0) setHomeContext(id, rows);\n                })\n                // error\n                .catch(error => {\n                    // finished loading\n                    setIsLoading(false);\n                    // show alert\n                    alert(\"Failed to get collection products\");\n                });\n            }\n        });\n    }\n    // ---------------- /LIFECYCLE ----------------\n    \n    // ---------------- RENDERING ----------------\n    function renderSlider(){\n        return <Carousel cols={props.cols || 5} rows={props.rows || 1} gap={15} loop>\n            {(homeContext[id] || []).map((p, idx) => (\n                <Carousel.Item key={`slide-image-${idx}`} >\n                    <Link to={`/products/${p.id}`}>\n                        <div className=\"product-grid\">\n                            <img src={productInfoExtractor(p).thumbnail} />\n                            {/* <div className=\"title\">{productInfoExtractor(p).title}</div> */}\n                            <div className=\"title\">{productInfoExtractor(p).title.substr(0, 40)}{productInfoExtractor(p).title.length > 40 ? \"...\" : \"\"}</div>\n                            <div className=\"price\">\n                                {function(){\n                                        // get currency\n                                        const currency = shop.currency.toUpperCase();\n                                        // get all prices\n                                        let prices = p.variants.map(v => (v.price || 0))\n                                            // get value larger then 0 only\n                                            .filter(p => p > 0)\n                                            // filter duplicate\n                                            .filter((v, i, a) => a.indexOf(v) === i)\n                                        // only one value\n                                        if(prices.length === 0) {\n                                            return `${currency} ${p.price || 0}`\n                                        } else if(prices.length < 2) {\n                                            return `${currency} ${prices[0] || 0}`\n                                        } else {\n                                            return `${currency} ${Math.min(...prices)} - HKD ${Math.max(...prices)}`\n                                        }\n                                }()}\n                            </div>\n                        </div>\n                    </Link>\n                </Carousel.Item>\n            ))}\n        </Carousel>;\n   }\n\n   function productInfoExtractor(product){\n        // set thumbnail\n        return {\n            title     : product.name,\n            thumbnail : ((((product.variants || []).filter(v => v.media.length > 0) || [])[0] || {}).media || [])[0].url || \"\",\n            price     : product.price\n        }\n   }\n   // ---------------- /RENDERING ----------------\n\n    // product data loaded?\n    return homeContext[id] && !isLoading ? <div className=\"widget-bestseller\" style={{...props.styles}}>\n        <h1>{customizeTitle || __(props.title)}</h1>\n        {renderSlider()}\n    </div> : \n    isLoading ? \n    <div style={{ width:\"100%\", height:500, display:\"flex\", alignItems:\"center\", justifyContent:\"center\" }}>\n        <MoonLoader \n            size={20}\n            color={\"#000000\"}\n            loading={true}\n        />\n    </div> : null;\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Product);","import Seperator from './Seperator';\nimport Banner from './Banner';\nimport Product from './Product';\nimport ArticleTile from './ArticleTile';\nimport CollectionProduct from './CollectionProduct';\n\n\nexport default { \n    Banner, \n    Product, \n    Seperator, \n    ArticleTile,\n    CollectionProduct\n};","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport './home.css';\nimport { connect } from 'react-redux';\nimport actions from '../../helpers/actions';\nimport { MoonLoader } from 'react-spinners';\nimport widgets from '../../components/widgets';\nimport { unstable_renderSubtreeIntoContainer } from 'react-dom';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    session : state.shop.session,\n    settings : state.shop.settings\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Home(props){\n\n    // get settings\n    let { settings } = props;\n    // get layout\n    const layout = settings.layout;\n\n    return (\n        <div className=\"home\">\n            {layout.content.map((widgetSettings, idx) => {\n                // get widget\n                let Widget = widgetSettings.widget != undefined && widgetSettings.widget.length > 0 ? widgets[widgetSettings.widget] : undefined;\n                // widget found?\n                if(Widget != undefined) {\n                    // return widget\n                    return <Widget \n                                index={idx}\n                                key={`widget-${widgetSettings.widget}-${idx}`} \n                                id={`widget-${widgetSettings.widget}-${idx}`} \n                                {...widgetSettings}\n                            />;\n                }\n            })}\n        </div>\n    );\n}\n\nexport default connect(mapStateToProps)(Home);","import React, { useState, useEffect } from 'react';\nimport Oneshop from 'oneshop.web';\nimport { Link } from 'react-router-dom';\nimport './products.css';\nimport { connect } from 'react-redux';\nimport actions from '../../helpers/actions';\nimport { MoonLoader } from 'react-spinners';\nimport Select from 'react-select';\nimport { extractByLocaleCode } from '../../helpers/AttributesHelper'\n\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    products           : state.product.products,\n    i18n               : state.i18n,\n    shop               : state.shop.session,\n    collections        : state.shop.collections || [],\n    selectedCollection : state.shop.selectedCollection || null,\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setProducts : (products) => dispatch({\n        type    : actions.SET_PRODUCTS,\n        payload : products\n    }),\n    setCollections : (collections) => dispatch({\n        type    : actions.SET_COLLECTIONS,\n        payload : collections\n    }),\n    setSelectedCollection : (collectionId) => dispatch({\n        type    : actions.SET_SELECTED_COLLECTION,\n        payload : collectionId\n    }),\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Product(props){\n\n    // oneshop instance\n    const OS = new Oneshop();\n    // get products\n    let { products, shop, collections, selectedCollection } = props;\n    // get translation method\n    let  { __, locale } = props.i18n;\n    // set end of page\n    let [endOfList, setEndOfList] = useState(false);\n    // statuses\n    let [status, setStatus] = useState({\n        loading : false\n    });\n    // special nav bar title?\n    const customizeTitles = extractByLocaleCode({\n        locale, shop\n    });\n\n\n    // ----------------------- LIFECYCYLE -----------------------\n    useEffect(() => {\n        // active fetch products if no product is loaded\n        if(!(products || []).length && !endOfList) fetchProducts();\n        // no collections?\n        if(!(collections || []).length) fetchCollections();\n    }, [products]);\n\n\n    async function fetchCollections(){\n        try {\n            // get shop collections\n            let collections = await fetch(`/api/collections`, { method : 'GET'});  \n            // parse json\n            collections = await collections.json();\n            // save collections\n            props.setCollections((collections.data || {}).rows || []);\n        } catch (error) {\n            // DO NOTHING\n            // if failed to fetch collection\n        }\n    }\n\n\n    function fetchProducts(){\n        if(!endOfList){\n            // start loading\n            toggleLoading();\n            // params\n            let params = {\n                page   : Math.ceil(products.length/15) + 1,\n                locale\n            };\n            // filter by collection?\n            if(!isNaN((selectedCollection || {}).value)) {\n                params.collections = selectedCollection.value;\n            } else if(selectedCollection === null || selectedCollection === undefined) {\n                delete params.selectedCollection\n            }\n            // fetch products\n            OS.merchandise.get(params)\n            // got products\n            .then((rows) => {\n                // end of list?\n                if(!rows.length) {\n                    // prevent further loading\n                    setEndOfList(true);\n                } else {\n                    // set products\n                    props.setProducts(products.concat(rows));\n                }\n                // has result\n                toggleLoading();\n            })\n            // error\n            .catch(error => console.error(error));\n        }\n    }\n    // ----------------------- /LIFECYCYLE -----------------------\n\n\n\n    // ----------------------- HELPERS -----------------------\n    function extractThumbnail(p){\n        let thumbnail_url = \"https://via.placeholder.com/150\";\n        let variantsHasThumbnails = p.variants.filter(v => v.media.length > 0);\n        if(variantsHasThumbnails.length > 0) thumbnail_url = variantsHasThumbnails[0].media[0].url;\n        return thumbnail_url;\n    }\n\n    function toggleLoading(){\n        setStatus(oldStatus => {\n            var newStatus = {...oldStatus};\n            // finish loading\n            newStatus.loading = !newStatus.loading;\n            // return new status set\n            return newStatus;\n        });\n    }\n    // ----------------------- /HELPERS -----------------------\n\n\n    return (\n        <div className=\"products\">\n            <div className=\"header-wrapper\">\n                {\n                    (collections || []).length ? \n                    <div className=\"header-wrapper\">\n                        <h1>{customizeTitles.nav_shop || __(\"Products\")} - </h1>\n                        <div className=\"collection-select\">\n                            <Select placeholder={__(\"All\")}\n                                    value={selectedCollection || null}\n                                    onChange={option => {\n                                        // start over\n                                        setEndOfList(false);\n                                        // clear product\n                                        props.setProducts([]);\n                                        // save selected collection\n                                        props.setSelectedCollection(option.value !== null ? option : null);\n                                    }}\n                                    options={[{ id : null, name : \"All\"}].concat((collections || [])).map(c => ({ value : c.id, label : __(c.name.toLowerCase())}))}\n                            />\n                        </div>\n                    </div> : \n                    <h1>{customizeTitles.nav_shop || __(\"Products\")}</h1>\n                }\n            </div>\n            <div className=\"list\">\n                {(products || []).map((p, idx) => (\n                    <div key={`product-${idx}`} className=\"item\">\n                        <Link to={`/products/${p.id}`}>\n                            <div className=\"item-wrapper\">\n                                <div className=\"thumbnail\">\n                                    <img src={extractThumbnail(p)} />\n                                </div>\n                                <div className=\"info\">\n                                    <div className=\"name\">{p.name}</div>\n                                    <div className=\"price\">{function(){\n                                        // get all prices\n                                        let prices = p.variants.map(v => (v.price || 0))\n                                            // get value larger then 0 only\n                                            .filter(p => p > 0)\n                                            // filter duplicate\n                                            .filter((v, i, a) => a.indexOf(v) === i)\n                                        // only one value\n                                        if(prices.length === 0) {\n                                            return `HKD ${p.price || 0}`\n                                        } else if(prices.length < 2) {\n                                            return `HKD ${prices[0] || 0}`\n                                        } else {\n                                            return `HKD ${Math.min(...prices)} - HKD ${Math.max(...prices)}`\n                                        }\n                                    }()}</div>\n                                </div>\n                            </div>\n                        </Link>\n                    </div>\n                ))}\n            </div>\n            <div style={{ width:\"100%\", display:\"flex\", justifyContent: \"center\", alignItems :\"center\", padding : \"30px 0px\" }}>\n                {\n                    status.loading === false ? \n                    <button className=\"load-more-btn\" onClick={fetchProducts}>\n                        {__(\"Load more\")}\n                    </button> :\n                    <MoonLoader \n                        size={20}\n                        color={\"#000000\"}\n                        loading={true}\n                    /> \n                }\n            </div>\n        </div>\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Product);","import React, { useState, useEffect } from 'react';\nimport Oneshop from 'oneshop.web';\nimport { useParams, Redirect, Link } from 'react-router-dom';\nimport { Slide } from 'react-slideshow-image';\nimport './product.detail.css';\nimport { MoonLoader } from 'react-spinners';\nimport { connect } from 'react-redux';\nimport actions from '../../../helpers/actions';\nimport HTMLParser from 'react-html-parser';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    cart : state.cart,\n    shop : state.shop.session,\n    i18n : state.i18n\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setCartItems : (items) => dispatch({\n        type    : actions.SET_CART_ITEMS,\n        payload : items\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction ProductDetail(props){\n\n    // oneshop instance\n    const OS = new Oneshop();\n    // get params\n    const params = useParams();\n    // products\n    let [product, setProduct] = useState({});\n    // setup variants \n    let [variants, setVariants] = useState({});\n    // statuses\n    let [status, setStatus] = useState({ loading : false, addingToCart : false });\n    // setup qty\n    let [qty, setQty] = useState(1);\n    // setup redirect\n    let [redirect, setRedirect] = useState(null);\n    // setup selected variant\n    let [selectedVariant, setSelectedVariant] = useState({});\n\n    // get cart\n    let { cart, shop } = props;\n    // get translation method\n    let  { __, locale } = props.i18n;\n\n\n    // ----------------------- LIFECYCYLE -----------------------\n    useEffect(() => {\n        // not loading?\n        if(!status.loading && !Object.keys(product).length){\n            // start loading\n            setLoading(true);\n            // fetch product by id\n            OS.merchandise.get({\n                ids: params.id,\n                locale\n            })\n            // got products\n            .then(rows => {\n                // no product found\n                if(!rows.length) setRedirect(\"/notfound\");\n                // set product\n                setProduct((() => {\n                    // manipulate product\n                    let p = {...rows[0]};\n                    // variants\n                    p.variants = p.variants.map(v => {\n                        // transform description\n                        v.description = v.description.split(\",\").map(o => ({ [o.split(\":\")[0]] : o.split(\":\")[1] })).reduce((optionSet, option) => Object.assign(optionSet, option), {});\n                        return v;\n                    });\n                    return p;\n                })());\n                // set variants\n                setVariants(function(){\n                    // extract options\n                    let options = {};\n                    (rows[0].variants || []).forEach(v => {\n                        Object.keys(v.description).forEach(o=> {\n                            // option name\n                            let optionName = o;\n                            // option value\n                            let optionValue = v.description[o];\n                            // if its undefined, set it as an empty Object\n                            options[optionName] = options[optionName] || {};\n                            // set value \n                            options[optionName][optionValue] = options[optionName][optionValue] || Object.keys(options[optionName]).length == 0;\n                        });\n                    });\n                    return options;\n                }());\n                // finish loading\n                setLoading(false);\n            })\n            // error\n            .catch(error => {\n                // finish loading\n                setLoading(false);\n                // not found\n                setRedirect(\"/notfound\");\n            });\n        }\n        // pre-select variant\n        if(Object.keys(variants).length > 0 && !Object.keys(selectedVariant).length){\n            Object.keys(variants).forEach(v => {\n                Object.keys(variants[v]).forEach(o => {\n                    if(variants[v][o] === true) {\n                        selectOption(v, o);\n                    }\n                });\n            });\n        }\n    }, [variants]);\n    // ----------------------- /LIFECYCYLE -----------------------\n\n\n\n\n    // ----------------------- HELPERS -----------------------\n    function setLoading(loading, cart = false){\n        setStatus(oldStatus => {\n            let newStatus = {...oldStatus};\n            // settings carts\n            if(cart){\n                newStatus.addingToCart = loading;\n            } else {\n                newStatus.loading = loading;\n            }\n            return newStatus;\n        });\n    }\n\n    function selectOption(selectedOption, selectedValue){\n        // alter variant states\n        setVariants(oldVariants => {\n            let newVariants = {...oldVariants};\n            Object.keys(newVariants[selectedOption]).forEach(valueName => (newVariants[selectedOption][valueName] = valueName == selectedValue));\n            return newVariants;\n        });\n        // set selected variants\n        setSelectedVariant(oldSelectedVariant => {\n            // clone options\n            let newSelectedVariant = {...oldSelectedVariant};\n            // save selected value\n            newSelectedVariant[selectedOption] = selectedValue;\n            // update\n            return newSelectedVariant;\n        });\n    }\n\n    function getSelectedVariant(){\n        // set variant container\n        let targetVariant = null;\n        // search for variant\n        ((product || {}).variants || []).forEach(v => {\n            // get description {}\n            let desc = v.description;\n            // at least identical in key length\n            if(Object.keys(selectedVariant).length === Object.keys(desc).length){\n                // set flag\n                let identical = true;\n                // compare with all keys\n                Object.keys(desc).forEach(key => {\n                    // values from desc\n                    let descVal = desc[key];\n                    // compare, set to false with no mercy\n                    if(descVal != selectedVariant[key]) identical = false;\n                });\n                if(identical) targetVariant = v;\n            }\n        });\n        return targetVariant;\n    }\n\n    async function addToCart(){\n        // start loading\n        setLoading(true, true);\n        // get selected variant Obj\n        let variant_id = (getSelectedVariant() || {}).id || null;\n        // get id?\n        if(variant_id){\n            // preset qty\n            let _qty = qty || 0;\n            // existed in cart?\n            cart.items.forEach(item => {\n                // append qty if already exists\n                if(item.id == variant_id) _qty += item.qty;\n            });\n            // add to cart\n            try {\n                // success?\n                await OS.cart.item.put(\n                    cart.id, \n                    {\n                        id  : variant_id, \n                        qty : _qty\n                    }\n                );\n                // get cart items\n                let items = await OS.cart.item.get(cart.id);\n                // set cart items\n                props.setCartItems(items);\n                // finish loading\n                setLoading(false, true);\n            } catch(error) {\n                // show alert msg\n                alert(\"Failed to add item to cart\");\n                // finish loading\n                setLoading(false, true);\n            }\n        }\n    }\n\n    // toggle qty\n    const qtyButtonOnClick = (increament = true) => {\n        // preset qty\n        let _qty = increament == true ? (parseInt(qty)+1) : (parseInt(qty)-1);\n        if(_qty < 1) _qty = 1;\n        // get selected variant\n        let v = getSelectedVariant() || { stock : 1 };\n        if(_qty >= v.stock) _qty = v.stock;\n        // set quantity\n        setQty(_qty);\n    };\n    // ----------------------- /HELPERS -----------------------\n\n\n\n\n    // ----------------------- RENDERING -----------------------\n    function renderSlides(){\n        // define properties\n        const properties = {\n            duration : 5000,\n            transitionDuration : 300,\n            infinite :  false,\n            indicators : true,\n            arrows : true\n        };\n        return <div className=\"slide-container\">\n            <Slide {...properties}>\n                {(() => {\n                    // urls container\n                    let urls = [];\n                    // append variant media to urls container\n                    (product.variants || []).forEach(v => v.media.forEach(m => urls.push(m.url)));\n                    // return slides\n                    return urls.filter((url, index) => urls.indexOf(url) === index).map((url, idx) => (\n                        <div key={`slide-image-${idx}`} className=\"each-slide\">\n                            <div style={{ backgroundImage : `url(${url})`}}>\n                            </div>\n                        </div>\n                    ));\n                })()}\n            </Slide>\n        </div>\n    }\n\n    function renderVariants(){\n        // get keys of variants\n        const keys = Object.keys(variants)\n        const valuesOfFirstOption = Object.values(keys[0] || {})\n        // only have one variant and one option, no need to choose\n        if(keys.length == 1 && valuesOfFirstOption.length == 1){\n            return null;\n        } else {\n            return Object.keys(variants).map(o => <div key={`variant-list-${o}`} className=\"list\">\n                <h4>{o.toUpperCase()}</h4>\n                <div className=\"items\">\n                    {Object.keys(variants[o]).map(v => {\n                        return <div onClick={() => {selectOption(o, v)}} key={`variant-${o}-${v}`} className={`item ${variants[o][v] === true ? \"selected\" : \"\"}`}>{v}</div>\n                    })}\n                </div>\n            </div>);   \n        }\n    }\n\n    function renderQtySelector() {\n        // should buttons disabled?\n        let shouldDisabled = (getSelectedVariant() || {}).stock <= 0;\n        // get select variant\n        let v = getSelectedVariant() || { stock : 1 };\n        return (\n            <div className=\"qty\">\n                <button \n                    onClick={() => qtyButtonOnClick(false)}\n                    disabled={shouldDisabled || qty == 1}\n                >\n                    <i className=\"fas fa-minus\"></i>\n                </button>\n                <div className=\"input\">\n                    <input value={qty}\n                            min={1}\n                            max={v.stock}\n                            onChange={e => setQty(/^[0-9]+$/.test(e.target.value) ? parseInt(e.target.value) : parseInt(qty))} \n                            type=\"number\" \n                            disabled={shouldDisabled}\n                    />\n                </div>\n                <button \n                    onClick={() => qtyButtonOnClick(true)}\n                    disabled={shouldDisabled || qty >= v.stock}>\n                        <i className=\"fas fa-plus\"></i>\n                </button>\n            </div>\n        )\n    }\n    // ----------------------- /RENDERING -----------------------\n\n    // get selected variant's object\n    let selectedVariantObj = getSelectedVariant() || {};\n\n    return status.loading ? \n        <div style={{ width : \"100%\", height : \"100vh\", display : \"flex\", justifyContent : \"center\", alignItems : \"center\" }}>\n            <MoonLoader \n                size={20}\n                color={\"#000000\"}\n                loading={true}\n            /> \n        </div>\n        :\n        (\n            // product not found? back to product list\n            redirect ? <Redirect to={redirect} /> : \n            (\n                <div className=\"product-detail\">\n                    <div className=\"cols\">\n                        <div className=\"back-button-wrapper\">\n                            <Link to={\"/products\"}>\n                                <i className=\"fas fa-chevron-left\"></i>\n                                {__(\"Back to products\")}\n                            </Link>\n                        </div>\n                        <div className=\"upper-row\">\n                            {renderSlides()}\n                        </div>\n                        <div className=\"lower-row\">\n                            <div className=\"description\">\n                                <h1>{product.name}</h1>\n                                <div className=\"price\">\n                                    {shop.currency.toUpperCase()} {(selectedVariantObj.price || 0).toFixed(2)}\n                                    {selectedVariantObj.stock == 0 ? <span className=\"out-of-stock\">Out of stock</span> : null}\n                                </div>\n                                <p>{HTMLParser(product.description || \"\")}</p>\n                                <div className=\"tags\">\n                                    {(product.tags || []).map(t => <div key={`product-tag-${t}`} className=\"tag\">#{t}</div>)}\n                                </div>\n                            </div>\n                            <div className=\"gap\" style={{width:\"50px\"}}></div>\n                            <div className=\"variants\">\n                                {renderVariants()}\n                                {renderQtySelector()}\n                                <button className=\"add-to-cart\" onClick={addToCart} disabled={selectedVariantObj.stock == 0 || status.addingToCart}>\n                                    {\n                                        status.addingToCart ? \n                                        <MoonLoader \n                                            size={20}\n                                            color={\"white\"}\n                                            loading={true}\n                                        /> :\n                                        __(\"Add to Cart\")\n                                    }\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )\n        )\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProductDetail);","import React, { useState, useEffect } from 'react';\nimport Oneshop from 'oneshop.web';\nimport { Link } from 'react-router-dom';\nimport './blog.css';\nimport { connect } from 'react-redux';\nimport actions from '../../helpers/actions';\nimport parseHTML from 'html-react-parser';\nimport { MoonLoader } from 'react-spinners';\nimport { extractByLocaleCode } from '../../helpers/AttributesHelper'\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    articles : state.article.articles,\n    shop     : state.shop.session,\n    i18n     : state.i18n\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setArticles : (articles) => dispatch({\n        type    : actions.SET_ARTICLES,\n        payload : articles\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\n\nfunction Blog(props){\n\n    // oneshop instance\n    const OS = new Oneshop();\n    // get articles\n    let { articles, shop } = props;\n    // statuses\n    var [status, setStatus] = useState({\n        loading : false\n    });\n    // load i18n settings\n    let { __, locale } = props.i18n;\n\n    // special nav bar title?\n    const customizeTitles = extractByLocaleCode({\n        locale, shop\n    });\n\n    // ----------------------- LIFECYCYLE -----------------------\n    useEffect(() => {\n        // active fetch articles if no product is loaded\n        if(!(articles || []).length) fetchArticles();\n    }, []);\n\n\n    function fetchArticles(){\n        // start loading\n        toggleLoading();\n        // fetch articles\n        OS.article.get({\n            page : Math.ceil(articles.length/15) + 1,\n            locale\n        })\n        // got articles\n        .then((rows) => {\n            // set articles\n            props.setArticles(articles.concat(rows));\n            // has result\n            toggleLoading();\n        })\n        // error\n        .catch(error => console.error(error));\n    }\n    // ----------------------- /LIFECYCYLE -----------------------\n\n\n\n    // ----------------------- HELPERS -----------------------\n    function thumbnailExtractor(a){\n        // default value\n        let thumbnail_url = \"https://via.placeholder.com/150\";\n        // has media?\n        let sectionHasMedia = a.sections.filter(v => v.media.length > 0);\n        // get first image as the thumbnail\n        if(sectionHasMedia.length > 0) thumbnail_url = sectionHasMedia[0].media[0].url;\n        // return's thumnail url\n        return thumbnail_url;\n    }\n\n    function captionExtractor(a){\n        // setup title container\n        let section = {};\n        // search title\n        (a.sections || []).forEach(s => {\n            // title not found yet and section title exists?\n            if(!Object.keys(section).length && s.title.length > 0) \n                // save the valid section\n                section = s;\n        });\n        // return result title\n        return section;\n    }\n\n    function toggleLoading(){\n        setStatus(oldStatus => {\n            var newStatus = {...oldStatus};\n            // finish loading\n            newStatus.loading = !newStatus.loading;\n            // return new status set\n            return newStatus;\n        });\n    }\n    // ----------------------- /HELPERS -----------------------\n\n\n    return (\n        <div className=\"blogs\">\n            <h1>{customizeTitles.nav_blog || __(\"Blog\")}</h1>\n            <div className=\"list\">\n            {articles.map(a => (\n                <div key={`blog-${a.id}`} className=\"blog\">\n                    <Link to={`/blogs/${a.id}`}>\n                        <div className=\"blog-wrapper\">\n                            <div className=\"thumbnail\">\n                                <img src={thumbnailExtractor(a)} />\n                            </div>\n                            <div className=\"info\">\n                                <div className=\"title\">{captionExtractor(a).title}</div>\n                                <div className=\"description\">{`${(captionExtractor(a).description || \"\").replace(/<[^>]*>?/gm, '').replace(/&[a-z]+;/gm, '').substr(0, 300)}...`}</div>\n                                <div className=\"time\">{new Date(a.time).toLocaleDateString()}</div>\n                            </div>\n                        </div>\n                    </Link>\n                </div>\n            ))}\n            </div>\n            <div style={{ width:\"100%\", display:\"flex\", justifyContent: \"center\", alignItems :\"center\", padding : \"30px 0px\" }}>\n                {\n                    status.loading === false ? \n                    <button className=\"load-more-btn\" onClick={fetchArticles}>\n                        {__(\"Load more\")}\n                    </button> :\n                    <MoonLoader \n                        size={20}\n                        color={\"#000000\"}\n                        loading={true}\n                    /> \n                }\n            </div>\n        </div>\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Blog);","import React, { useState, useEffect } from 'react';\nimport Oneshop from 'oneshop.web';\nimport { useParams, Redirect, Link } from 'react-router-dom';\nimport { Slide } from 'react-slideshow-image';\nimport './blog.detail.css';\nimport { MoonLoader } from 'react-spinners';\nimport parseHTML from 'html-react-parser';\nimport { connect } from 'react-redux';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    i18n : state.i18n\n});\n// ------------------------ /REDUX ------------------------\n\nfunction ArticleDetail(props){\n\n    // oneshop instance\n    const OS = new Oneshop();\n    // get params\n    const params = useParams();\n    // articles\n    let [article, setArticle] = useState({});\n    // statuses\n    let [status, setStatus] = useState({ loading : false });\n    // setup redirect\n    let [redirect, setRedirect] = useState(null);\n\n    // get i18n settings\n    let { __, locale } = props.i18n;\n\n\n    // ----------------------- LIFECYCYLE -----------------------\n    useEffect(() => {\n        // not loading?\n        if(!status.loading && !Object.keys(article).length){\n            // start loading\n            setLoading(true);\n            // fetch article by id\n            OS.article.get({\n                ids: params.id,\n                locale\n            })\n            // got articles\n            .then(rows => {\n                // no article found\n                if(!rows.length) setRedirect(\"/notfound\");\n                // save article\n                setArticle(rows[0]);\n                // finish loading\n                setLoading(false);\n            })\n            // error\n            .catch(error => {\n                // finish loading\n                setLoading(false);\n                // not found\n                setRedirect(\"/notfound\");\n            });\n        }\n    }, []);\n    // ----------------------- /LIFECYCYLE -----------------------\n\n\n\n\n    // ----------------------- HELPERS -----------------------\n    function setLoading(loading){\n        setStatus(oldStatus => {\n            let newStatus = {...oldStatus};\n            newStatus.loading = loading;\n            return newStatus;\n        });\n    }\n    // ----------------------- /HELPERS -----------------------\n\n\n    // ----------------------- RENDERING -----------------------\n    function renderSlider(s){\n         // define properties\n         const properties = {\n            duration : 5000,\n            transitionDuration : 300,\n            infinite :  false,\n            indicators : true,\n            arrows : true\n        };\n        return <div className=\"slide-container\">\n            <Slide {...properties}>\n                {(s.media || []).map((m, idx) => (\n                    <div key={`slide-image-${idx}`} className=\"each-slide\">\n                        <div style={{ backgroundImage : `url(${m.url})`}}></div>\n                    </div>\n                ))}\n            </Slide>\n        </div>\n        \n    }\n\n    function renderSections(a){\n        return (a.sections || []).map((s,idx, sections) => (\n            <div key={`article-section-${idx}`} className=\"section\">\n                {s.media.length > 0 ? renderSlider(s) : null}\n                {idx == 0 && sections.length > 1 ? <h1>{s.title}</h1> : <h2>{s.title}</h2>}\n                {idx == 0 ? <span>{new Date(a.time).toLocaleDateString()}</span> : null}\n                <p>{parseHTML(s.description)}</p>\n            </div>\n        ));\n    }\n    // ----------------------- /RENDERING -----------------------\n\n\n\n    return status.loading ? \n        <div style={{ width : \"100%\", height : \"100vh\", display : \"flex\", justifyContent : \"center\", alignItems : \"center\" }}>\n            <MoonLoader \n                size={20}\n                color={\"#000000\"}\n                loading={true}\n            /> \n        </div>\n        :\n        (\n            // article not found? back to article list\n            redirect ? <Redirect to={redirect} /> : \n            (\n                <div className=\"article-detail\">\n                    <div className=\"article-detail-wrapper\">\n                        <div className=\"back-button-wrapper\">\n                            <Link to={\"/blogs\"}>\n                                <i className=\"fas fa-chevron-left\"></i>\n                                {__(\"Back\")}\n                            </Link>\n                        </div>\n                        <div className=\"content\">\n                            {renderSections(article)}\n                        </div>\n                    </div>\n                </div>\n            )\n        )\n}\n\nexport default connect(mapStateToProps)(ArticleDetail);","import React from 'react';\n\nfunction NotFound(){\n    return (\n        <div>\n            404 Not Found\n        </div>\n    )\n}\n\nexport default NotFound;","const validate = function(path, form){\n    // get rule\n    const rule = findRuleByPath(path);\n    // get value from form obj\n    const value = getValueAtObjectByPath(path, form);\n    // return error msg if rule and error exists\n    return rule ? getFieldError(rule, value) : null;\n};\n\n\n// setup validation rules\nconst rules = {\n    contact : {\n        first_name : {\n            field_name : \"First Name\",\n            regex : /^.*$/,\n            required : true\n        },\n        last_name : {\n            field_name : \"Last Name\",\n            regex : /^.*$/,\n            required : true\n        },\n        email : {\n            field_name : \"Email\",\n            regex : /^[a-zA-Z0-9\\-\\_\\.]+\\@([0-9a-zA-Z\\-\\_]+\\.)+[a-zA-Z0-9\\-\\_]+$/,\n            required : true\n        },\n        phone : {\n            field_name : \"Phone\",\n            regex : /^\\+?[0-9]+$/,\n            required : true\n        }\n    },\n    payment : {\n        card : {\n            field_name : \"Card Number\",\n            regex : /^([0-9]{4}\\-?){4}$/,\n            required : true\n        },\n        csc : {\n            field_name : \"CVC\",\n            regex : /^[0-9]{3,4}$/,\n            required : true\n        },\n        exp_date : {\n            field_name : \"Expiry\",\n            regex : /^[0-9]{2}\\/?[0-9]{2}$/,\n            required : true\n        }\n    },\n    coupons :  {\n        field_name : \"Coupon\",\n        regex : /^[a-zA-Z0-9]+$/,\n        required : false\n    },\n    shipping : {\n        address : {\n            field_name : \"Address\",\n            regex : /^.*$/,\n            required : true\n        },\n        country : {\n            field_name : \"Country\",\n            regex : /^[A-Z]{2}$/,\n            required : true\n        }\n    }\n};\n\n\n\n// ----- helpers ------\nconst findRuleByPath = (path) => getValueAtObjectByPath(path, rules);\n\n\nconst getValueAtObjectByPath = function(path, form){\n    const drill = (paths, obj) => {\n        // get path\n        let path = paths.shift();\n        // still need to get sub path?\n        if(paths.length > 0){\n            // ensure its a object\n            if(obj[path] && Object.prototype.toString.call(obj[path]) === \"[object Object]\"){\n                return drill(paths, obj[path]);\n            } else {\n                return obj[path] || null;\n            }\n        } else {\n            return obj[path] || null;\n        }\n    };\n    return drill(path.split(\".\"), form);\n}\n\n\nconst deleteValueAtObjectByPath = function (obj, path) {\n    if (!obj || !path) {\n      return;\n    }\n    if (typeof path === 'string') {\n      path = path.split('.');\n    }\n    for (var i = 0; i < path.length - 1; i++) {  \n      obj = obj[path[i]];\n      if (typeof obj === 'undefined') {\n        return;\n      }\n    }\n    delete obj[path.pop()];\n}\n\nconst setValueAtObjectByPath = function(_obj, field, value){\n    const assignHandler = (obj, prop, value) => {\n        if (typeof prop === \"string\")\n            prop = prop.split(\".\");\n        if (prop.length > 1) {\n            var e = prop.shift();\n            assignHandler(obj[e] =\n                    Object.prototype.toString.call(obj[e]) === \"[object Object]\"\n                    ? obj[e]\n                    : {},\n                prop,\n                value);\n        } else\n            obj[prop[0]] = value;\n    }\n    return assignHandler(_obj, field, value);\n}\n\n\nconst getFieldError = function(rule, value){\n    // has input\n    if((value || \"\").length){\n        return (new RegExp(rule.regex, \"ig\")).test(value) ? \n            null : \n            {\n                field : rule.field_name,\n                error : `is invalid`\n            };\n    } else\n    // not empty\n    if(rule.required === true && !(value || \"\").length){\n        return {\n            field : rule.field_name,\n            error : `is required`\n        };\n    }\n}\n\n\n\nexport { \n    validate, \n    getValueAtObjectByPath, \n    deleteValueAtObjectByPath, \n    setValueAtObjectByPath \n};","import React, { useState } from 'react';\nimport Oneshop from 'oneshop.web';\nimport './checkout.css';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport actions from '../../helpers/actions';\nimport { MoonLoader } from 'react-spinners';\nimport Select from 'react-select';\nimport {getCodeList} from 'country-list';\nimport Tooltip from 'react-tooltip';\nimport { validate, getValueAtObjectByPath, setValueAtObjectByPath, deleteValueAtObjectByPath } from '../../helpers/formValidator';\nimport { Redirect } from 'react-router-dom';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    cart : state.cart,\n    shop : state.shop.session,\n    user : state.user.session,\n    i18n : state.i18n\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setCartItems : (items) => dispatch({\n        type    : actions.SET_CART_ITEMS,\n        payload : items\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nconst countryEscape = (c) => {\n    const escapeCountries = {\n        'Taiwan, Province of China' : 'Taiwan'\n    };\n    return escapeCountries[c] || c;\n}\nconst countriesNeedExtraInfo = [\"tw\"];\n\n\nfunction Checkout(props){\n\n    // oneshop instance\n    const OS = new Oneshop();\n    // get cart and shop\n    let {cart, shop, user} = props;\n    // steps\n    let [step, setStep] = useState(1);\n    // shipping methods\n    let [shippingMethods, setShippingMethods] = useState([]);\n    // loading?\n    let [isLoading, setIsLoading] = useState(false);\n    // preview\n    let [preview, setPreview] = useState(null);\n    // paid?\n    let [paid, setPaid] = useState(null);\n    // form\n    let [form, setForm] = useState({\n        contact : {\n            first_name : \"\",\n            last_name : \"\",\n            email : \"\",\n            phone : \"\"\n        },\n        payment : {\n            card : \"\",\n            csc : \"\",\n            exp_date : \"\"\n        },\n        shipping : {\n            address : null,\n            country : \"HK\"\n        },\n        shippings : {\n            [shop.id] : null\n        },\n        items : cart.id,\n        notes : \"\"\n    });\n    let [extraInfo, setExtraInfo] = useState(\"\");\n    let [formErrors, setFormErrors] = useState({});\n    // country code list\n    const countries = getCodeList();\n    // translation method\n    let { __ } = props.i18n;\n    \n    // -------------------- HELPERS --------------------\n    async function loadShippingMethods(){\n        // set loading\n        setIsLoading(true);\n        // setup shipping methods\n        let shipping_methods = [];\n        // process shipping methods\n        try {\n            // fetch shipping methods\n            let customShippings = await fetch(\n                '/api/shipping_methods', \n                { \n                    method : \"GET\" \n                }\n            );\n            // transform json\n            customShippings = (((((await customShippings.json()) || {}).data || {}).rows || [])[0] || {}).shipping_methods || [];\n            // append to container\n            shipping_methods = shipping_methods.concat(customShippings.filter(s => {\n                // get selected destination country\n                const _country = form.shipping.country || \"HK\"\n                // check does it valid for the shipping method\n                return (s.exclude_countries || []).indexOf(_country) < 0\n            }).map(s => ({\n                id               : s.code.replace(/\\r?\\n|\\r/g, \"\"),\n                charge           : s.charge,\n                title            : s.title,\n                address_required : s.shipping_address_required\n            })));\n            // has auto ship?\n            if(shop.auto_ship){\n                let autoShippings = await fetch(\n                    `/api/carts/${cart.id}/shipment/rates`, \n                    {\n                        method : \"POST\",\n                        body : JSON.stringify({\n                            shipping : {\n                                address : \"HK\",\n                                country : form.shipping.country\n                            }\n                        })\n                    }\n                );\n                // transform json\n                autoShippings = (await autoShippings.json()).data.rows;\n                // append to container\n                shipping_methods = shipping_methods.concat(autoShippings.filter(s => s.rates[shop.id] != undefined).map(s => ({\n                    id               : s.id,\n                    charge           : s.rates[shop.id],\n                    title            : s.name,\n                    address_required : true\n                })));\n            }\n            // preselect one shipping method\n            if(shipping_methods.length && form.shippings[shop.id] == null) {\n                setFormValue(`shippings.${shop.id}`, shipping_methods[0].id);\n            }\n            // set shipping method\n            setShippingMethods(shipping_methods);\n            // got to step 2\n            setStep(2);\n            // finish loading\n            setIsLoading(false);\n        } catch (error) {\n            alert(\"Failed to load shipping methods\");\n            // loading finish\n            setIsLoading(false);\n        }\n    }\n\n    async function previewOrder(){\n        // set loading\n        setIsLoading(true);\n        try {\n            // clone form\n            let previewForm = {...form};\n            // remove coupon field if coupons field is empty\n            if((previewForm.coupons || \"\").trim().length == 0) delete previewForm.coupons;\n            // remove shippings if not shipping method is selected\n            if(previewForm.shippings[shop.id] == null) delete previewForm.shippings[shop.id];\n            // fetch order previews\n            let preview = await fetch(\n                `/api/carts/${cart.id}/previews`, \n                { \n                    method : \"POST\",\n                    body : JSON.stringify({\n                        ...previewForm\n                    })\n                }\n            );\n            // parse json\n            preview = (await preview.json());\n            // got error\n            if(preview.data){\n                preview = preview.data.rows[0];\n                // set preview object\n                setPreview(preview);\n                // go to step 3\n                setStep(3);\n            } else {\n                alert(preview.messages ? (preview.messages || []).join(\"\\n\") : \"Failed to confirm order amount.\");\n            }\n            // loading finish\n            setIsLoading(false);\n        } catch (error) {\n            alert(\"Failed to confirm order amount.\");\n            // loading finish\n            setIsLoading(false);\n        }\n    }\n\n    async function makePayment(){\n        // set loading\n        setIsLoading(true);\n        // clone form\n        let payload = {...form};\n        // ----- manupulate form data\n        // no coupon?\n        if(!(payload.coupons || \"\").trim().length) delete payload.coupons;\n        // no notes?\n        if(!(payload.notes || \"\").trim().length) delete payload.notes;\n        // has extra information\n        if((extraInfo || \"\").trim().length || (payload.notes || \"\").trim().length) {\n            // append extra information\n            payload.notes = JSON.stringify({ [shop.id] : (extraInfo || \"\") + \"\\n\" + (payload.notes || \"\") });\n        }\n        // split expiry\n        payload.payment.exp_date = `${payload.payment.exp_date.slice(0,2)}/${payload.payment.exp_date.slice(2)}`;\n        // trying to make payment\n        try {\n            // make payment\n            let payment = user != null ? (await OS.consumer.checkout(payload)) : (await OS.order.place(payload));\n            // success?\n            if(payment.rows && \n                (payment.rows || []).length > 0){\n                // set paid object and go to /checkout/success\n                setPaid({\n                    ...preview,\n                    shipping : form.shipping,\n                    contact : form.contact,\n                    notes : form.notes || \"\",\n                    items : [...cart.items],\n                });\n            } else {\n                // unknown error\n                alert(\"Unknown error occured, please try again\");\n            }\n            // finished loading\n            setIsLoading(false);\n        } catch (error) {\n            // error messages\n            if(Array.isArray(error.message) && (error.message || []).length > 0){\n                alert(error.message.join(\"\\n\"))\n            } else {\n                // unknow error\n                alert(\"Unknown error occured, please try again\");\n            }\n            // finished loading\n            setIsLoading(false);\n        }\n        \n    }\n\n    function setFormValue(field, value){\n        setForm(oldForm => {\n            let newForm = {...oldForm};\n            setValueAtObjectByPath(newForm, field, value);\n            return newForm;\n        });\n    }\n    // -------------------- /HELPERS --------------------\n\n\n    // -------------------- ERROR HANDLING --------------------\n    function getFormErrorView(path){\n        // get error\n        const error_msg = getValueAtObjectByPath(path, formErrors) || null;\n        return <span className=\"error-msg\">{error_msg || \"\"}</span>;\n    }\n    \n    function validateField(field){\n        // validate\n        let error_msg = validate(field || \"\", form);\n        // not null? translate\n        if(error_msg != null) error_msg = `${__(error_msg.field)} ${__(error_msg.error)}`;\n        // has error?\n        setFormErrors(oldFormErrors => {\n            let newFormErrors = {...oldFormErrors};\n            // save error if has error has error msg\n            // otherwise delete error message from formErrors\n            error_msg ? setValueAtObjectByPath(newFormErrors, field, error_msg) : deleteValueAtObjectByPath(newFormErrors, field);\n            return newFormErrors;\n        });\n    }\n\n    function isFormValid(){\n        // preset result\n        let isValid = true;\n        // loop through the process\n        ['contact', 'payment', 'shipping'].forEach(field => {\n            // field exists\n            if(formErrors[field] != undefined && Object.keys(formErrors[field]).length > 0){\n                isValid = false;\n            }\n        });\n        return isValid;\n    }\n    // -------------------- /ERROR HANDLING --------------------\n\n\n    // -------------------- FORM RENDERING --------------------\n    function renderStep1(){\n        return <div className=\"step-1\">\n            <h2>{__(\"Your Information\")}</h2>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <label>{__(\"First Name\")}</label>\n                    <input placeholder={__(\"Peter\")} \n                            value={form.contact.first_name} \n                            onChange={(e) => setFormValue('contact.first_name', e.target.value)}\n                            onBlur={() => validateField(\"contact.first_name\")}\n                    />\n                    {getFormErrorView(\"contact.first_name\")}\n                </div>\n                <div className=\"form-group\">\n                    <label>{__(\"Last Name\")}</label>\n                    <input placeholder={__(\"Chan\")}\n                            value={form.contact.last_name} \n                            onChange={(e) => setFormValue('contact.last_name', e.target.value)}\n                            onBlur={() => validateField(\"contact.last_name\")}\n                    />\n                    {getFormErrorView(\"contact.last_name\")}\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <label>{__(\"Email\")}</label>\n                    <input placeholder=\"Peter.chan@abc.com\" \n                            value={form.contact.email} \n                            onChange={(e) => setFormValue('contact.email', e.target.value)}\n                            onBlur={() => validateField(\"contact.email\")}\n                    />\n                    {getFormErrorView(\"contact.email\")}\n                </div>\n                <div className=\"form-group\">\n                    <label>{__(\"Phone\")}</label>\n                    <input placeholder=\"+85291234567\" \n                            value={form.contact.phone} \n                            onChange={(e) => setFormValue('contact.phone', e.target.value)}\n                            onBlur={() => validateField(\"contact.phone\")}\n                    />\n                    {getFormErrorView(\"contact.phone\")}\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <label>{__(\"Country\")}</label>\n                    <Select value={{ \n                                value : (form.shipping.country || \"hk\").toLowerCase(), \n                                label: __(countryEscape(countries[(form.shipping.country || \"hk\").toLowerCase()]))\n                            }}\n                            onChange={option => setFormValue('shipping.country', option.value.toUpperCase())}\n                            options={Object.keys(countries).map(key => (\n                                { \n                                    value : key, \n                                    label : __(countryEscape(countries[key]))\n                                }\n                            ))}\n                    />\n                </div>\n                <div className=\"form-group\">\n                {\n                    countriesNeedExtraInfo.indexOf((form.shipping.country || \"hk\").toLowerCase()) > -1 &&\n                    <>\n                        <label>{__(\"Extra information\")}</label>\n                        <input placeholder={__(\"e.g. Your Taiwan ID card number\")}\n                                value={extraInfo} \n                                onChange={e => setExtraInfo(e.target.value)}\n                        />\n                    </>\n                }\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"form-group\"></div>\n                <div className=\"form-group\">\n                    <button onClick={() => loadShippingMethods()} \n                            disabled={\n                                !(form.contact.first_name || \"\").length ||\n                                !(form.contact.last_name || \"\").length ||\n                                !(form.contact.email || \"\").length ||\n                                !(form.contact.phone || \"\").length ||  // triggers the button to disable at form init\n                                !isFormValid()\n                            }\n                    >\n                        {__(\"Shipping\")} <i className=\"fas fa-chevron-right\"></i>\n                    </button>\n                </div>\n            </div>\n        </div>\n    }\n\n    function renderStep2(){\n        return <div className=\"step-2\">\n            <h2>{__(\"Select a Shipping Method\")}</h2>\n            <div className=\"row\">\n                <div className=\"shipping-methods\">\n                    {\n                        shippingMethods.length ? \n                        shippingMethods.map(s => (\n                            <div key={`shipping-method-${s.id}`} \n                                className={`shipping-method ${form.shippings[shop.id] == s.id ? \"selected\" : \"\"}`}\n                                onClick={() => setFormValue(`shippings.${shop.id}`, s.id)}\n                            >\n                                {form.shippings[shop.id] == s.id ? <i className=\"fas fa-check-square\"></i> : <i className=\"far fa-check-square\"></i>}\n                                <div className=\"title\">{s.title}</div> - \n                                <div className=\"charge\">{shop.currency.toUpperCase()} {s.charge}</div>\n                            </div>\n                        )) :\n                        <div className=\"shipping-method-none\">{__(\"No shipping method is available at the moment.\")}</div>\n                    }\n                </div>\n            </div>\n            <h2>{__(\"Shipping Address\")}</h2>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <input placeholder=\"1/F, ABC Building, 12 ABC Road, Hong Kong\" value={form.shipping.address || \"\"} \n                            onChange={(e) => setFormValue('shipping.address', e.target.value)}\n                            onBlur={() => validateField(\"shipping.address\")}\n                    />\n                    {getFormErrorView(\"shipping.address\")}\n                </div>\n            </div>\n            <h2>{__(\"Coupons\")}</h2>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <input placeholder=\"SUMMERSALE10\" \n                            value={form.coupons || \"\"} \n                            onChange={(e) => setFormValue('coupons', e.target.value)}\n                            onBlur={() => validateField(\"coupons\")}\n                    />\n                    {getFormErrorView(\"coupons\")}\n                </div>\n            </div>\n            <h2>{__(\"Notes\")}</h2>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <textarea \n                        value={form.notes || \"\"}\n                        placeholder={__(\"Notes to us\")}\n                        maxLength={500}\n                        onChange={(e) => setFormValue('notes', e.target.value)} \n                    />\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <button onClick={() => {\n                                setFormErrors({});\n                                setStep(1);\n                            }}\n                    >\n                        <i className=\"fas fa-chevron-left\"></i> {__(\"Information\")}\n                    </button>\n                </div>\n                <div className=\"form-group\">\n                    <button onClick={() => previewOrder()}\n                            disabled={!(form.shipping.address || \"\").length || !isFormValid()}\n                    >\n                        {__(\"Payment\")} <i className=\"fas fa-chevron-right\"></i>\n                    </button>\n                </div>\n            </div>\n        </div>\n    }\n\n    function renderStep3(){\n        return <div className=\"step-3\">\n            <h2>{__(\"Payment\")}</h2>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <label>{__(\"Card Number\")}</label>\n                    <input placeholder=\"4242-4242-4242-4242\" \n                            value={((form.payment.card || \"\").match(new RegExp('[0-9]{1,4}', 'g')) || []).join(\"-\")} \n                            onChange={(e) => setFormValue('payment.card', (e.target.value || \"\").split(\"-\").join(\"\"))} \n                            maxLength={19}\n                            onBlur={() => validateField(\"payment.card\")}\n                    />\n                    {getFormErrorView(\"payment.card\")}\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <label>{__(\"Expiry Date\")}</label>\n                    <input placeholder=\"10/20\" \n                            value={((form.payment.exp_date || \"\").match(new RegExp('[0-9]{1,2}', 'g')) || []).join(\"/\")} \n                            onChange={(e) => setFormValue('payment.exp_date', (e.target.value || \"\").split(\"/\").join(\"\"))} \n                            onBlur={() => validateField(\"payment.exp_date\")}\n                            maxLength={5}\n                    />\n                    {getFormErrorView(\"payment.exp_date\")}\n                </div>\n                <div className=\"form-group\">\n                    <label>{__(\"CSC\")}</label>\n                    <input placeholder=\"123\" \n                            type=\"password\"\n                            value={form.payment.csc || \"\"} \n                            onChange={(e) => setFormValue('payment.csc', e.target.value)} \n                            onBlur={() => validateField(\"payment.csc\")}\n                            maxLength={4}\n                    />\n                    {getFormErrorView(\"payment.csc\")}\n                </div>\n            </div>\n            <div className=\"row\">\n                <div className=\"form-group\">\n                    <button onClick={() => {\n                        setPreview(null);\n                        setFormErrors({});\n                        setStep(2);\n                    }}>\n                        <i className=\"fas fa-chevron-left\"></i> {__(\"Shipping\")}\n                    </button>\n                </div>\n                <div className=\"form-group\">\n                    <button className=\"pay-btn\" \n                            onClick={makePayment}\n                            disabled={\n                                !(form.payment.card || \"\").length ||\n                                !(form.payment.exp_date || \"\").length ||\n                                !(form.payment.csc || \"\").length ||\n                                !isFormValid()\n                            }\n                    >\n                        {__(\"Confirm & Pay\")} <i className=\"fas fa-check-circle\"></i>\n                    </button>\n                </div>\n            </div>\n        </div>\n    }\n\n    const renderStep = [renderStep1, renderStep2, renderStep3];\n\n    function renderOrderForm(){\n        return (\n            <div className=\"checkout\">\n                <h1>{__(\"Checkout\")}</h1>\n                <div className=\"checkout-wrapper\">\n    \n                    {/* ---------------- Loading mask ---------------- */}\n                    {\n                        isLoading ? \n                        <div className=\"loading-mask\">\n                            <MoonLoader \n                                size={20}\n                                color={\"#000000\"}\n                                loading={true}\n                            />\n                        </div> : null\n                    }\n                    {/* ---------------- /Loading mask ---------------- */}\n    \n                    {/* ---------------------- STEPS ---------------------- */}\n                    <div className=\"steps\">\n    \n                        {/* --------------- Progress Bar --------------- */}\n                        <div className=\"progress-bar\">\n                            {[\"Information\", \"Shipping\", \"Finish\"].map((s, idx) => (\n                                <div key={`step-label-${idx}`} className={`step-label ${step >= idx+1 ? \"active\" : \"\"}`}>\n                                    {__(s)}\n                                </div>\n                            ))}\n                            <div className=\"bar\">\n                                <div className=\"bar-fill\" style={{width:`${((step-1)/2)*100}%`}}></div>\n                            </div>\n                        </div>\n                        {/* --------------- /Progress Bar --------------- */}\n    \n                        {/* --------------- FORM --------------- */}\n                        <div className=\"form\">\n                            {renderStep[step-1]()}\n                        </div>\n                        {/* --------------- /FORM --------------- */}\n                        \n                        {/* --------------- Back to shoping cart button ------------- */}\n                        <div className=\"back-to-shopping-cart\">\n                            <Link to={\"/cart\"}>\n                                <i className=\"fas fa-chevron-left\"></i>\n                                {__(\"Back to Shopping Cart\")}\n                            </Link>\n                        </div>\n                        {/* --------------- /Back to shoping cart button ------------- */}\n                    </div>\n                    {/* ---------------------- /STEPS ---------------------- */}\n    \n    \n                    <div style={{width:15}}></div>\n    \n                    {/* ---------------------- SUMMARY ---------------------- */}\n                    <div className=\"summary\">\n                        <div className=\"summary-wrapper\">\n                            <h3>{__(\"Summary\")}</h3>\n                            <div className=\"amounts\">\n                                <div className=\"amt subtotal\">\n                                    <label>{__(\"Subtotal\")}</label> \n                                    <div className=\"amount\">\n                                        {shop.currency.toUpperCase()} {(() => {\n                                            return preview ? preview.sub_total : \n                                            (cart.items || []).reduce((total, item) => {\n                                                return total + (item.qty * item.price);\n                                            }, 0)\n                                        })().toFixed(2)}\n                                    </div>\n                                </div>\n                                <div className=\"amt shipping-fee\"> \n                                    <label>{__(\"Shipping fee\")}</label>\n                                    <div className=\"amount\">\n                                        {shop.currency.toUpperCase()} {(() => {\n                                            // has preview?\n                                            if(preview){\n                                                return preview.shipping_fee;\n                                            } else if(form.shippings[shop.id] != null){\n                                                return (shippingMethods.filter(s => s.id == form.shippings[shop.id])[0] || {}).charge || 0;\n                                            } else {\n                                                return 0;\n                                            }\n                                        })().toFixed(2)}\n                                    </div>\n                                </div>\n                                {\n                                    preview && ((preview.breakdowns[0] || {}).discounts || []).length > 0 ?\n                                    (\n                                        <div className=\"amt discounts\">\n                                            <label>{__(\"Discounts\")}</label>\n                                            {preview.breakdowns[0].discounts.map(d => (<div key={`discount-${d.id}`} className=\"item\">\n                                                <label data-tip={d.title || \"\"}>\n                                                    {(d.title || \"\").length > 20 ? `${(d.title || \"\").substring(0, 20)}...` : d.title}\n                                                    <Tooltip />\n                                                </label>\n                                                <div className=\"deducted-amt\">- {shop.currency.toUpperCase()} {d.amount}</div>\n                                            </div>))}\n                                        </div>\n                                    ) : null\n                                }\n                                <div className=\"amt total\">\n                                    <label>{__(\"TOTAL\")}</label>\n                                    <div className=\"amount\">\n                                        {shop.currency.toUpperCase()} {(() => {\n                                            return preview ? preview.gross_total : \n                                            (() => {\n                                                // get sub total\n                                                let subTotal = (cart.items || []).reduce((total, item) => {\n                                                    return total + (item.qty * item.price);\n                                                }, 0);\n                                                // get shipping fee\n                                                let shippingFee = form.shippings[shop.id] != null ? (shippingMethods.filter(s => s.id == form.shippings[shop.id])[0] || {}).charge : 0;\n                                                // return grand total\n                                                return subTotal + shippingFee;\n                                            })()\n                                        })().toFixed(2)}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    {/* ---------------------- /SUMMARY ---------------------- */}\n                </div>\n            </div>\n        );\n    }\n    // -------------------- /FORM RENDERING --------------------\n\n\n    // Render starting point\n    return paid ? <Redirect to={{ pathname : \"/checkout/success\", state : paid }} /> : renderOrderForm();\n    \n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Checkout);","import Cookies from \"universal-cookie\";\nconst cookies = new Cookies();\n\n\n/** @endpoint_wws */\nconst endpoint = \"wss://enquiry.oneshop.cloud\";\n//const endpoint = \"ws://localhost\";\n\n// setup ws\nlet ws = null;\n\nconst clearProtocol = (cb) => {\n    try {\n        // remove\n        cookies.remove('protocol', { samesite : 'None', secure : false, path : \"/\" })\n        // close connection\n        if(ws != null && typeof ws.close == 'function') ws.close();\n    } catch (error) {}\n    cb && cb();\n};\n\n\n\nconst getProtocol = () => {\n     // ------------------------- protocol -------------------------\n    // save to storage\n    let protocol = cookies.get('protocol');\n    // has protocol?\n    if(protocol == null){\n        // generate a new one\n        protocol = uuid();\n        // save to storage\n        cookies.set('protocol', protocol, { samesite : 'None', secure : false, path : \"/\" });\n    }\n    // ------------------------- /protocol -------------------------\n    return protocol;\n}\n\n\n\nconst getClient = async (cb) => {\n    \n    // ------------------------- Connection -------------------------\n    // connect to web socket\n    ws = new WebSocket(endpoint, getProtocol());\n    // setup reconnect retryTimer\n    let retryTimer = null;\n    // setup keep alive timer\n    let respawnTimer = null;\n    // is connecting\n    let isConnecting = false;\n    // commands container\n    let commands = {};\n    // broadcastListeners container\n    let broadcastListeners = {};\n    // reconnecting listeners\n    let connectionListeners = {};\n\n\n    const keepConnectionAlive = () => {\n        // interval of sending ping mssage to server\n        const intervalInSeconds = 15;\n        // AWS ELB default connection timeout is 60 seconds\n        // to keep the websocket client connection alive\n        // send msg every 15 seconds\n        respawnTimer = setTimeout(() => {\n            // ensure it still valid\n            if(ws && ws.readyState == WebSocket.OPEN) {\n                // send some bullshit\n                ws.send(`{\"message\":\"keep in touch!\"}`);\n                // broadcast is connected\n                Object.values(connectionListeners).forEach(l => typeof l == 'function' && l(true));\n            } else {\n                // disconnected?\n                reconnect();\n            }\n            // loop func\n            keepConnectionAlive();\n        }, intervalInSeconds * 1000);\n    }\n\n\n    // on open handler\n    const onopen = async () => {\n        console.log('====> connection opened, protocol: ', await getProtocol());\n        // cancel reconnect retryTimer\n        retryTimer && clearTimeout(retryTimer);\n        // connected\n        isConnecting = false;\n        // reset respawn timer\n        respawnTimer && clearTimeout(respawnTimer);\n        // keep connection alive\n        keepConnectionAlive();\n        // broadcast to all the client is connected\n        Object.values(connectionListeners).forEach(l => typeof l == 'function' && l(true));\n        // return the connected client\n        cb && cb(ws);\n    };\n\n    const attachMethods = (ws) => {\n        // ---- bind methods ---\n        ws.payload = { method : \"get\" }; // init payload\n        ws.setAction = (action) => { ws.payload = ws.payload || {}; ws.payload.action = action; return ws; } // set action api\n        ws.setArguments = (args) => { ws.payload = ws.payload || {}; ws.payload.arguments = args; return ws; } // set argument api\n        ws.setForm = (form) => { ws.payload = ws.payload || {}; ws.payload.form = form; return ws; } // set form api\n        ws.setMethod = (method) => { ws.payload = ws.payload || {}; ws.payload.method = method; return ws; } // set form method api\n        ws.cmd = (handler, idCallback) => {\n            ws.payload = ws.payload || {};\n            // set id\n            ws.payload.id = uuid();\n            // register handler\n            commands[ws.payload.id] = {\n                handler,\n                idCallback\n            };\n            // has id callback?\n            commands[ws.payload.id].idCallback != undefined && commands[ws.payload.id].idCallback(ws.payload.id);\n            // send command\n            if(ws != undefined && ws.readyState === WebSocket.OPEN) ws.send(JSON.stringify(ws.payload));\n            // clear payload context\n            ws.payload = { method : \"get\" };\n        }\n        // broadcast listener\n        ws.getBroadCastListener = (identifier) => { return broadcastListeners[identifier]; };\n        ws.registerBroadCastListener = (identifier, listener) => { broadcastListeners[identifier] = listener; };\n        ws.removeBroadCastListener = (identifier) => { delete broadcastListeners[identifier]; };\n        // connection Status listener\n        ws.getConnectionListeners = (identifier) => { return connectionListeners[identifier]; };\n        ws.registerConnectionListeners = (identifier, listener) => { connectionListeners[identifier] = listener; };\n        ws.removeConnectionListeners = (identifier) => { delete connectionListeners[identifier]; };\n\n        ws.onmessage = (msg) => {\n            // result container\n            let result = {};\n            // parse json\n            try { result = JSON.parse(((msg || {}).data || '')); } \n            catch (error) { result = result || {}; }\n            // broadcast message\n            if(result.broadcast != undefined) {\n                Object.values(broadcastListeners).forEach(l => typeof l == 'function' && l(result.broadcast));\n            }\n            // has id?\n            if(result.id && typeof commands[result.id].handler == \"function\"){\n                // execute handler\n                commands[result.id].handler(result);\n                // remove handlers\n                delete commands[result.id];\n            }\n        }\n        // ---- /bind methods ---\n    };\n    // attach method\n    attachMethods(ws);\n\n    // reconnection handler\n    const reconnect = () => {\n        // reset respawn timer\n        respawnTimer && clearTimeout(respawnTimer);\n        // is not connecting?\n        if(!isConnecting){\n            // connecting\n            isConnecting = true;\n            // execute after one second\n            retryTimer = setTimeout(async () => { \n                // trying to connect\n                ws = new WebSocket(endpoint, getProtocol());\n                // broadcast reconnecting\n                Object.values(connectionListeners).forEach(l => typeof l == 'function' && l(false));\n                // attach method\n                attachMethods(ws);\n                // opened\n                ws.onopen = onopen;\n                // when connection is closed OR error\n                ws.onclose = reconnect;\n                ws.onerror = reconnect;\n            } , 1000);\n        }\n    };\n    \n    // connected successfully\n    ws.onopen = onopen;\n\n    // when connection is closed OR error\n    ws.onclose = reconnect;\n    ws.onerror = reconnect;\n    // ------------------------- /Connection -------------------------\n\n}\n\n// ----------------- helper functions --------------------- //\nfunction uuid() {\n    var d = Date.now();\n    if (typeof performance !== 'undefined' && typeof performance.now === 'function'){\n      d += performance.now(); //use high-precision timer if available\n    }\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n      var r = (d + Math.random() * 16) % 16 | 0;\n      d = Math.floor(d / 16);\n        return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\n    });\n}\n// ----------------- /helper functions --------------------- //\n\nexport default {\n    getClient, clearProtocol, uuid\n};\n\n\n","import React, { useState, useEffect } from 'react';\nimport Oneshop from 'oneshop.web';\nimport './profile.css';\nimport { connect } from 'react-redux';\nimport { MoonLoader } from 'react-spinners';\nimport actions from '../../../helpers/actions';\nimport ws from '../../../helpers/websocket';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    shop    : state.shop.session,\n    i18n    : state.i18n,\n    profile : state.user.profile\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setProfile : profile => dispatch({\n        type    : actions.SET_USER,\n        payload : profile\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction UserProfile(props){\n    \n    // get oneshop instance\n    let OS = new Oneshop();\n    // get translation method\n    const { __ } = props.i18n;\n    // get profile and set profile method\n    const {profile, setProfile} = props;\n    // form data for updating profile\n    let [form, setForm] = useState(profile || {});\n    // loading status\n    let [isLoading, setIsLoading] = useState(false);\n    // my order history\n    let [orders, setOrders] = useState([]);\n    // end of list?\n    let [endOfList, setEndOfList] = useState(false);\n\n\n    // ------------------ LIFECYCLE -------------------\n    useEffect(() => {\n        // load orders\n        // if(!orders.length && !endOfList) fetchOrders();\n    }, []);\n    // ------------------ /LIFECYCLE -------------------    \n\n\n\n    // ------------------ ORDERS ---------------------\n    const fetchOrders = () => {\n        // start loading\n        setIsLoading(true);\n        // fetch orders\n        OS.order.history.get({ page : Math.ceil(orders.length/15 + 1)})\n        // gor orders\n        .then(rows => {\n            // loading finished\n            setIsLoading(false);\n            // has order retrieved?\n            if(rows.length){\n                // append orders\n                setOrders(orders.concat(rows));\n            } else {\n                // set end of list\n                setEndOfList(true);\n            }\n        })\n        // error\n        .catch(error => alert(error.messages.join(\"\\n\")));\n    }\n    // ------------------ /ORDERS --------------------\n\n\n    // ------------------ HELPERS ------------------\n    async function logout(){\n        // set loading\n        setIsLoading(true);\n        // clear websocket protocol as well\n        ws.clearProtocol();\n        // logging out\n        OS.consumer.logout()\n        .then(() => {\n            // loading finished\n            setIsLoading(false);\n            // clear profile\n            setProfile(null);\n            // redirect\n            window.location.pathname = \"/users\";\n        })\n        .catch(error => {\n            // loading finished\n            setIsLoading(false);\n            // show error msg\n            alert(error.message);\n        });\n    }\n\n    async function updateProfile(){\n        try {\n            // set loading\n            setIsLoading(true);\n            // update profile\n            await OS.consumer.profile.update(form);\n            // save form\n            setProfile({...form});\n            // finish loading\n            setIsLoading(false);\n        } catch (error) {\n            // finish loading\n            setIsLoading(false);\n            // show error msg\n            alert(error.message);\n        }\n    }\n\n\n    function updateFormData(key, value){\n        setForm(oldForm => {\n            // clone old form\n            let newForm = {...oldForm};\n            // update form data\n            newForm[key] = value;\n            // return updated form\n            return newForm;\n        });\n    }\n\n    function hasChanges(){\n        // preset result to false\n        let formChanged = false;\n        // searh any changes in profile\n        Object.keys(profile || {}).forEach(key => {\n            // changes has been made\n            if(form[key] != undefined && profile[key] != form[key]){\n                // set to true\n                formChanged = true;\n            }\n        });\n        // return result\n        return formChanged;\n    }\n    // ------------------ /HELPERS ------------------\n\n    return (\n        <div className=\"profile\">\n            <div className=\"profile-wrapper\">\n                <div className=\"left-col\">\n                    <h1>{__(\"Profile\")}</h1>\n                    <div className=\"data-group\">\n                        <label>{__(\"First Name\")}</label>\n                        <input value={form.first_name} onChange={(e) => updateFormData('first_name', e.target.value)} />\n                    </div>\n                    <div className=\"data-group\">\n                        <label>{__(\"Last Name\")}</label>\n                        <input value={form.last_name} onChange={(e) => updateFormData('last_name', e.target.value)} />\n                    </div>\n                    {\n                        hasChanges() ? \n                        // show save button and cancel button\n                        <div>\n                            <button onClick={updateProfile} disabled={isLoading}>\n                                {\n                                    isLoading ? \n                                    <MoonLoader \n                                        size={20}\n                                        color={\"white\"}\n                                        loading={true}\n                                    /> :\n                                    __(\"Save\")\n                                }\n                            </button>\n                            <button className=\"light\" onClick={() => setForm({...profile})} disabled={isLoading}>\n                                {__(\"Cancel\")}\n                            </button>\n                        </div> : \n                        // show logout button only if no changes\n                        <button className=\"light\" onClick={logout} disabled={isLoading}>\n                            {\n                                isLoading ? \n                                <MoonLoader \n                                    size={20}\n                                    color={\"black\"}\n                                    loading={true}\n                                /> :\n                                __(\"Logout\")\n                            }\n                        </button>\n                    }\n                </div>\n                <div className=\"right-col\">\n                    <h1>{__(\"My Orders\")}</h1>\n                    <div>\n\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserProfile);","import React, { useEffect, useState } from 'react';\nimport Oneshop from 'oneshop.web';\nimport ProfilePage from './Profile';\nimport { Redirect } from 'react-router-dom';\nimport './user.css';\nimport { MoonLoader } from 'react-spinners';\nimport { connect } from 'react-redux';\nimport actions from '../../helpers/actions';\n\n\n// --------------------- REDUX ---------------------\nconst mapStateToProps = state => ({\n    shop     : state.shop.session,\n    settings : state.shop.settings,\n    i18n     : state.i18n,\n    profile  : state.user.profile\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setProfile : profile => dispatch({\n        type    : actions.SET_USER,\n        payload : profile\n    })\n});\n// --------------------- /REDUX ---------------------\n\n\n\n\nfunction User(props){\n    \n    let [isLoading, setIsLoading] = useState(true);\n    let OS = new Oneshop();\n    let { profile, setProfile } = props;\n\n    // --------------- LIFECYCLE ---------------\n    useEffect(() => {\n        // retreive profile eveyr time\n        OS.consumer.profile.get()\n        // got \n        .then((rows) => {\n            var user = rows[0];\n            setProfile(user);\n            setIsLoading(false);\n        })\n        .catch((error) => {\n            setIsLoading(false);\n            setProfile(null);\n        });\n    },[]);\n    // --------------- /LIFECYCLE ---------------\n\n    return (\n        <div className=\"user\">\n            <div className=\"wrapper\">\n                { \n                    isLoading ? \n                    // show loading screen when loading\n                    loadingScreen() \n                    : (\n                        // logged in already?\n                        profile ? \n                        // show profile\n                        <ProfilePage profile={profile}/> \n                        : \n                        // redriect to loging page\n                        <Redirect to=\"/users/login\"/>\n                    )}\n            </div>\n        </div>\n    );\n}\n\nfunction loadingScreen(){\n    return (<div className=\"loading\">\n        <MoonLoader \n            size={20}\n            color={\"#000000\"}\n            loading={true}\n        /> \n    </div>);\n}\n\n export default connect(mapStateToProps, mapDispatchToProps)(User);\n\n","import React, { useState, useEffect } from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport Oneshop from 'oneshop.web';\nimport './register.css';\nimport { connect } from 'react-redux';\nimport { MoonLoader } from 'react-spinners';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    shop    : state.shop.session,\n    i18n    : state.i18n,\n    profile : state.user.profile\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Register(props){\n\n    // form data state\n    let [email, setEmail] = useState(\"\");\n    let [password, setPassword] = useState(\"\");\n    let [confirmPassword, setConfirmPassword] = useState(\"\");\n    let [firstName, setFirstName] = useState(\"\");\n    let [lastName, setLastName] = useState(\"\");\n    // loading status\n    let [isLoading, setIsLoading] = useState(false);\n    // redirect path\n    let [redirect, setRedirect] = useState(null);\n    // is registered flag\n    let [isRegistered, setIsRegistered] = useState(false)\n    // get oneshop instance\n    let OS = new Oneshop();\n    // get shop\n    const { shop, profile } = props;\n    // get translation method\n    const { __ } = props.i18n;\n\n    // ------------------ LIFECYCLE ------------------\n    useEffect(() => {\n        // logged in already?\n        if(profile != null){\n            // back to users page\n            setRedirect('/users');\n        }\n    }, []);\n    // ------------------ /LIFECYCLE ------------------\n\n    // -------------------- HELPER --------------------\n    function register(){\n        // set loading\n        setIsLoading(true);\n        // sign up\n        OS.consumer.signUp({\n            email      : email,\n            passwd     : password,\n            confpasswd : confirmPassword,\n            first_name : firstName,\n            last_name  : lastName\n        })\n        .then(() => {\n            // finished loading\n            setIsLoading(false);\n            // registered\n            setIsRegistered(true);\n        })\n        .catch(error => {\n            // finished loading\n            setIsLoading(false);\n            // error message\n            alert(error.message);\n        });\n    }\n\n    const isValid = (() => {\n        return isRegistered === true || \n            (\n                firstName.length > 0 &&\n                lastName.length > 0 &&\n                email.length > 0 &&\n                password.length > 0 &&\n                confirmPassword.length > 0\n            )\n    })()\n    // -------------------- /HELPER --------------------\n\n    // -------------------- RENDER ------------------------\n    const renderRegistrationForm = () => (\n        <>\n            <div className=\"form-group\">\n                <label>{__(\"First Name\")}</label>\n                <input \n                    type=\"text\" \n                    value={firstName} \n                    onChange={(event) => { setFirstName(event.target.value); }}\n                    placeholder={__(\"Peter\")}\n                    disabled={isLoading}\n                />\n            </div>\n            <div className=\"form-group\">\n                <label>{__(\"Last Name\")}</label>\n                <input \n                    type=\"text\" \n                    value={lastName} \n                    onChange={(event) => { setLastName(event.target.value); }}\n                    placeholder={__(\"Chan\")}\n                    disabled={isLoading}\n                />\n            </div>\n            <div className=\"form-group\">\n                <label>{__(\"Email\")}</label>\n                <input \n                    type=\"text\" \n                    value={email} \n                    onChange={(event) => { setEmail(event.target.value); }}\n                    placeholder=\"peter.chan@abc.com\"\n                    disabled={isLoading}\n                />\n            </div>\n            <div className=\"form-group\">\n                <label>{__(\"Password\")}</label>\n                <input \n                    type=\"password\" \n                    value={password}  \n                    onChange={(event) => { setPassword(event.target.value); }}\n                    placeholder=\"・・・・・・・・\"\n                    disabled={isLoading}\n                />\n            </div>\n            <div className=\"form-group\">\n                <label>{__(\"Confirm Password\")}</label>\n                <input \n                    type=\"password\" \n                    value={confirmPassword}  \n                    onChange={(event) => { setConfirmPassword(event.target.value); }}\n                    placeholder=\"・・・・・・・・\"\n                    disabled={isLoading}\n                />\n            </div>\n        </>\n    )\n\n    const renderSuccessMessage = () => (\n        <div className=\"\">\n            {__(\"registered_successfully\")}\n        </div>\n    )\n    // -------------------- /RENDER ------------------------\n\n    return redirect != null ? <Redirect to={redirect} /> : (\n        <div className=\"user-register\">\n            <div className=\"user-register-wrapper\">\n                <div className=\"form\">\n                    <div className=\"greeting\">\n                        {shop.logo ? <img src={shop.logo}/> : null}\n                        <h1>{__(\"Get Your Account\")}</h1>\n                    </div>\n                    <div className=\"form-wrapper\">\n                        {\n                            isRegistered === true ? \n                            renderSuccessMessage() :\n                            renderRegistrationForm()\n                        }\n                        <button \n                            onClick={() => {\n                                isRegistered ? setRedirect(\"/users\") : register()\n                            }} \n                            disabled={isLoading || !isValid}\n                        >\n                            {\n                                isLoading ? \n                                <MoonLoader \n                                    size={20}\n                                    color={\"white\"}\n                                    loading={true}\n                                /> :\n                                __(isRegistered ? \"Go Login\" : \"Register\")\n                            }\n                        </button>\n                        {!isRegistered && <div className=\"register\">\n                            <Link to=\"/users/login\">{__(\"Already a member?\")}</Link>\n                        </div>}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default connect(mapStateToProps)(Register);","import React, { useState, useEffect } from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport Oneshop from 'oneshop.web';\nimport './login.css';\nimport { connect } from 'react-redux';\nimport { MoonLoader } from 'react-spinners';\nimport actions from '../../../helpers/actions';\nimport ws from '../../../helpers/websocket';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    shop    : state.shop.session,\n    i18n    : state.i18n,\n    profile : state.user.profile\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setProfile : profile => dispatch({\n        type    : actions.SET_USER,\n        payload : profile\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Login(props){\n\n    // email state\n    let [email, setEmail] = useState(\"\");\n    // password state\n    let [password, setPassword] = useState(\"\");\n    // loading status\n    let [isLoading, setIsLoading] = useState(false);\n    // redirect path\n    let [redirect, setRedirect] = useState(null);\n    // get oneshop instance\n    const OS = new Oneshop();\n    // get shop\n    const { shop, setProfile, profile } = props;\n    // get i18n method\n    const { __ } = props.i18n;\n\n\n    // ------------------ LIFECYCLE ------------------\n    useEffect(() => {\n        // retreive profile eveyr time\n        OS.consumer.profile.get()\n        // got \n        .then((rows) => {\n            // get user\n            let user = rows[0];\n            // logged in already?\n            if(user != null){\n                // update user profile\n                setProfile(profile);\n                // back to users page\n                setRedirect('/users');\n            }\n        })\n        .catch((error) => {\n            // ignore error    \n        });\n    }, []);\n    // ------------------ /LIFECYCLE ------------------\n\n    // -------------------- HELPER --------------------\n    function login(){\n        // start loading\n        setIsLoading(true);\n        // execute two task\n        Promise.all([\n            // http login\n            OS.consumer.login({\n                email  : email,\n                passwd : password\n            }),\n            // login to websocket as well\n            new Promise((resolve, reject) => {\n                // handler\n                const handler = (result) => {\n                    result.result ? resolve() : reject();\n                }\n                // get websocket client\n                ws.getClient(c => {\n                    c.setAction(\"/login\").setArguments({ shopId : shop.id }).setForm({ email, passwd : password }).cmd(handler);\n                });\n            })\n        ])\n        // login success\n        .then(() => {\n            // finish loading\n            setIsLoading(false);\n            // redirect to checking again\n            window.location.href = \"/users\";\n        })\n        // error\n        .catch(error => {\n            // finish loading\n            setIsLoading(false);\n            // show message\n            alert(__(\"invalid_credential\"));\n        });\n    }\n    // -------------------- /HELPER --------------------\n\n\n    return redirect != null ? <Redirect to={redirect} /> : (\n        <div className=\"user-login\">\n            <div className=\"user-login-wrapper\">\n                <div className=\"form\">\n                    <div className=\"greeting\">\n                        {shop.logo ? <img src={shop.logo}/> : null}\n                        <h1>{__(\"Welcome Back\")}</h1>\n                    </div>\n                    <div className=\"form-wrapper\">\n                        <div className=\"form-group\">\n                            <label>{__(\"Email\")}</label>\n                            <input \n                                type=\"text\" \n                                value={email} \n                                onChange={(event) => { setEmail(event.target.value); }}\n                                placeholder=\"peter.chan@abc.com\"\n                            />\n                        </div>\n                        <div className=\"form-group\">\n                            <label>{__(\"Password\")}</label>\n                            <input \n                                type=\"password\" \n                                value={password}  \n                                onChange={(event) => { setPassword(event.target.value); }}\n                                placeholder=\"・・・・・・・・\"\n                            />\n                        </div>\n                        <div className=\"recovery-btn\">\n                            <Link to=\"/users/account_rescue\">{__(\"Password Recovery/Account Activation?\")}</Link>\n                        </div>\n                        <button onClick={login} disabled={isLoading}>\n                            {\n                                isLoading ? \n                                <MoonLoader \n                                    size={20}\n                                    color={\"white\"}\n                                    loading={true}\n                                /> :\n                                __(\"Login\")\n                            }\n                        </button>\n                        <div className=\"register\">\n                            <Link to=\"/users/new\">{__(\"Not a member? Register now!\")}</Link>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Login);","import React, { useState, useEffect } from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport Oneshop from 'oneshop.web';\nimport './recovery.css';\nimport { connect } from 'react-redux';\nimport { MoonLoader } from 'react-spinners';\nimport actions from '../../../helpers/actions';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    shop    : state.shop.session,\n    i18n    : state.i18n,\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setProfile : profile => dispatch({\n        type    : actions.SET_USER,\n        payload : profile\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Recovery(props){\n\n    // get oneshop instance\n    const OS = new Oneshop();\n    // get shop\n    const { shop, setProfile, profile } = props;\n    // get i18n method\n    const { __ } = props.i18n;\n    // recovery type\n    const [type, setType] = useState(\"recovery\");\n    // step\n    const [step, setStep] = useState(1);\n    // password reset form\n    let [form, setForm] = useState({\n        id : \"\",\n        code : \"\",\n        passwd : \"\",\n        confpasswd : \"\"\n    })\n    // email state\n    let [email, setEmail] = useState(\"\");\n    // loading status\n    let [isLoading, setIsLoading] = useState(false);\n    // redirect path\n    let [redirect, setRedirect] = useState(null);\n\n\n    // ------------------ LIFECYCLE ------------------\n    useEffect(() => {\n        // retreive profile eveyr time\n        OS.consumer.profile.get()\n        // got \n        .then((rows) => {\n            // get user\n            let user = rows[0];\n            // logged in already?\n            if(user != null){\n                // update user profile\n                setProfile(profile);\n                // back to users page\n                setRedirect('/users');\n            }\n        })\n        .catch((error) => {\n            // ignore error    \n        });\n    }, []);\n    // ------------------ /LIFECYCLE ------------------\n\n    // -------------------- HELPER --------------------\n    const isResetPass = /^recovery$/.test(type);\n\n    function sendRecoveryEmail(){\n        // start loading\n        setIsLoading(true);\n        // create validation\n        OS.validation.create({\n            email,\n            type : isResetPass ? \"code\" : \"link\"\n        })\n        // login success\n        .then(res => {\n            console.log(\"---> row: \", res);\n            // finish loading\n            setIsLoading(false);\n            // save validation id if reset password\n            if(isResetPass) {\n                setForm({\n                    ...form,\n                    id : res.rows[0].id\n                })\n            }\n            // next step\n            setStep(2);\n        })\n        // error\n        .catch(error => {\n            // finish loading\n            setIsLoading(false);\n            console.log(error)\n            // show message\n            alert(((error || {}).messages || [])[0] || __(\"Please ensure the email address is correct\"));\n        });\n    }\n\n    function resetPassword() {\n        // start loading\n        setIsLoading(true);\n        // create validation\n        OS.validation.consume(form.id, {\n            ...form\n        })\n        // login success\n        .then(([row]) => {\n            console.log(\"---> row: \", row);\n            // finish loading\n            setIsLoading(false);\n            // next step\n            setStep(3);\n        })\n        // error\n        .catch(error => {\n            // finish loading\n            setIsLoading(false);\n            // show message\n            alert(((error || {}).messages || [])[0] || __(\"Please ensure the code is correct and it's enter within 15mins\"));\n        });\n    }\n\n\n    const isValid = function(){\n        if(step === 1) {\n            return /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/.test(email || \"\")\n        } else if(step === 2 && isResetPass) {\n            return /^[0-9]{6}$/.test(form.code) && form.passwd.trim().length >= 8 && form.passwd == form.confpasswd\n        } else {\n            return true\n        }\n    }()\n    // -------------------- /HELPER --------------------\n\n    // -------------------- Rendering ----------------------- //\n    const showSuccessMsg = () => (\n        <div className=\"success-msg\">\n            {__(isResetPass ? \"reset_pw_ok_1\" : \"reset_pw_ok_2\")}\n        </div>\n    )\n\n    const renderPasswordForm = () => (\n        <>\n            <div className=\"form-group\">\n                <label>{__(\"Enter the code you have received in your email\")}</label>\n                <input \n                    type=\"text\" \n                    value={form.code} \n                    onChange={(event) => { setForm({ ...form, code : event.target.value }); }}\n                    placeholder={__(\"6 digits code\")}\n                    disabled={isLoading}\n                />\n            </div>\n            <div className=\"form-group\">\n                <label>{__(\"New Password\")}</label>\n                <input \n                    type=\"password\" \n                    value={form.password} \n                    onChange={(event) => { setForm({ ...form, passwd : event.target.value }); }}\n                    placeholder=\"．．．．．．．．\"\n                    disabled={isLoading}\n                />\n            </div>\n            <div className=\"form-group\">\n                <label>{__(\"Confirm New Password\")}</label>\n                <input \n                    type=\"password\" \n                    value={form.confPassword} \n                    onChange={(event) => { setForm({ ...form, confpasswd : event.target.value }); }}\n                    placeholder=\"．．．．．．．．\"\n                    disabled={isLoading}\n                />\n            </div>\n        </>\n    )\n\n    const renderBasicForm = () => (\n        <>\n            <div className=\"form-group\">\n                <label>{__(\"1. Choose your action\")}</label>\n                <div className=\"recovery-options\">\n                    <button \n                        onClick={() => setType(\"recovery\")} \n                        style={{ \n                            fontWeight : isResetPass ? \"700\" : \"500\",\n                            textDecoration : isResetPass ? \"underline\" : \"none\"\n                        }} \n                        disabled={step > 1}\n                    >\n                        {__(\"Reset password\")}\n                    </button>\n                    <button \n                        onClick={() => setType(\"activate\")} \n                        style={{ \n                            fontWeight : !isResetPass ? \"700\" : \"500\",\n                            textDecoration : !isResetPass ? \"underline\" : \"none\"\n                        }}\n                        disabled={step > 1}\n                    >\n                        {__(\"Resend activation email\")}\n                    </button>\n                </div>\n            </div>\n            <div className=\"form-group\">\n                <label>{__(\"2. Enter Your Email\")}</label>\n                <input \n                    type=\"text\" \n                    value={email} \n                    onChange={(event) => { setEmail(event.target.value); }}\n                    placeholder=\"peter.chan@abc.com\"\n                    disabled={step > 1}\n                />\n            </div>\n        </>\n    )\n    // -------------------- /Rendering ----------------------- //\n\n\n    return redirect != null ? \n        <Redirect to={redirect} /> : \n        <div className=\"recovery\">\n            <div className=\"recovery-wrapper\">\n                <div className=\"form\">\n                    <div className=\"greeting\">\n                        {shop.logo ? <img src={shop.logo}/> : null}\n                        <h1>{__(\"Find Your Account\")}</h1>\n                    </div>\n                    <div className=\"form-wrapper\">\n                        {\n                            // Selection and email input\n                            ((step < 3 && isResetPass) || step == 1) ? renderBasicForm() : null\n                        }\n                        {\n                            // Password form\n                            step === 2 && isResetPass ? renderPasswordForm() : null \n                        }\n                        {\n                            // success message\n                            (step == 2 && !isResetPass) || (step == 3 && isResetPass) ? showSuccessMsg() : null\n                        }\n                        <button\n                            onClick={() => {\n                                if(step === 1) {\n                                    // send\n                                    sendRecoveryEmail();\n                                } else if(step === 2 && isResetPass) {\n                                    // reset pass\n                                    resetPassword()\n                                } else {\n                                    // go back\n                                    setRedirect(\"/users\");\n                                }\n                            }}\n                            disabled={isLoading || !isValid}\n                        >\n                            {\n                                isLoading ? \n                                <MoonLoader \n                                    size={20}\n                                    color={\"white\"}\n                                    loading={true}\n                                /> :\n                                __(step === 1 ? \"Confirm\" : (step === 2 && isResetPass ? \"Reset Password\" : \"Go Login\"))\n                            }\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Recovery);","import React, { useState } from 'react';\nimport Oneshop from 'oneshop.web';\nimport './cart.css';\nimport { connect } from 'react-redux';\nimport actions from '../../helpers/actions';\nimport { MoonLoader } from 'react-spinners';\nimport { Link } from 'react-router-dom';\n\n\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    cart : state.cart,\n    shop : state.shop.session,\n    i18n : state.i18n\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setCartItems : (items) => dispatch({\n        type    : actions.SET_CART_ITEMS,\n        payload : items\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Cart(props){\n\n    // oneshop instance\n    const OS = new Oneshop();\n    // loading state\n    let [isLoading, setIsLoading] = useState(false);\n    // get cart items\n    let { cart, shop } = props;\n    // get translation method\n    let { __ } = props.i18n;\n\n    // ------------------------ HELPERS ------------------------\n    function extractThumbnail(item){\n        let thumbnail_url = \"https://via.placeholder.com/150\";\n        if((item.media || []).length > 0) thumbnail_url = item.media[0];\n        return thumbnail_url;\n    }\n\n    \n    async function removeItem(itemId){\n        // set loading\n        setIsLoading(true);\n        // success?\n        try {\n            // remove item\n            await OS.cart.item.remove(cart.id, itemId);\n            // refresh cart\n            await refreshCart();\n            // removed\n            setIsLoading(false);\n        } catch (error) {\n            // show error\n            alert(\"Failed to remove item\");\n            // finish loading\n            setIsLoading(false);\n        }\n    }\n\n    async function editItemQty(itemId, qty){\n        // set loading\n        setIsLoading(true);\n        // success?\n        try {\n            // remove item\n            await OS.cart.item.put(cart.id, {\n                id  : itemId,\n                qty : qty\n            });\n            // refresh cart\n            await refreshCart();\n            // removed\n            setIsLoading(false);\n        } catch (error) {\n            // show error\n            alert(\"Failed to edit item qty\");\n            // finish loading\n            setIsLoading(false);\n        }\n    }\n\n    async function refreshCart(){\n        // get cart item\n        try {\n            let items = await OS.cart.item.get(cart.id);\n            // set items\n            props.setCartItems(items);\n        } catch (error) {\n            // error on get items\n            alert(\"Failed to get cart item\");\n        }\n    }\n    // ------------------------ /HELPERS ------------------------\n\n\n\n    // ------------------------ REDNERS ------------------------\n    function renderList(){\n        return <div className=\"items\">\n            {\n                isLoading ? \n                <div className=\"loading-mask\">\n                    <MoonLoader \n                        size={20}\n                        color={\"#000000\"}\n                        loading={true}\n                    />\n                </div> : null\n            }\n            {(cart.items || []).map((item, idx) => (\n                <div key={`item-${idx}`} className=\"item\">\n                    <div className=\"thumbnail\">\n                        <img src={extractThumbnail(item)} alt={item.name}/>\n                    </div>\n                    <div className=\"info\">\n                        <div className=\"name\">\n                            {item.name}\n                        </div>\n                        <div className=\"description\">\n                            {item.variant}\n                        </div>\n                    </div>\n                    <div className=\"form\">\n                        <div className=\"unit-price\">\n                            {(shop.currency || \"hkd\").toUpperCase()} {item.price.toFixed(2)} <i className=\"fas fa-times\"></i>\n                        </div>\n                        <div className=\"qty\">\n                            {item.qty}\n                        </div>\n                        <div className=\"qty-btns\">\n                            <button onClick={() => editItemQty(item.id, item.qty + 1)}>\n                                <i className=\"fas fa-sort-up\"></i>\n                            </button>\n                            <button onClick={() => item.qty < 2 ? removeItem(item.id) : editItemQty(item.id, item.qty - 1)}>\n                                <i className=\"fas fa-sort-down\"></i>\n                            </button>\n                        </div>\n                    </div>\n                    <div className=\"subtotal\">\n                        {(shop.currency || \"hkd\").toUpperCase()} {(item.price * item.qty).toFixed(2)}\n                    </div>\n                    <div className=\"remove-btn-wrapper\">\n                        <button onClick={() => removeItem(item.id)}>\n                            <i className=\"fas fa-trash\"></i>\n                        </button>\n                    </div>\n                </div>\n            ))}\n            <div className=\"checkout-btn-wrapper\">\n                <div className=\"total\">\n                    {__(\"Total\")} : {(shop.currency || \"hkd\").toUpperCase()} {(cart.items || []).reduce((total, item) => {\n                        return (total + (item.qty * item.price));\n                    }, 0).toFixed(2)}\n                </div>\n                <Link to=\"/checkout\">\n                    {__(\"Checkout\")}\n                </Link>\n            </div>\n        </div>\n    }\n\n    function renderPlaceholder(){\n        return <div className=\"placeholder\">\n            <i className=\"fas fa-shopping-cart\"></i>\n            <div className=\"message\">\n                {__(\"Your shopping cart is empty.\")}\n            </div>\n            <Link to=\"/products\">{__(\"Shop Now\")}</Link>\n        </div>\n    }\n    // ------------------------ REDNERS ------------------------\n\n\n    return (\n        <div className=\"cart\">\n            <h1>{__(\"My Cart\")}</h1>\n            <div className=\"list\">\n                {(cart.items || []).length ? renderList() : renderPlaceholder()}\n            </div>\n        </div>\n    );\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Cart);","import React, { useEffect } from 'react';\nimport Oneshop from 'oneshop.web';\nimport './order.snapshot.css';\nimport { useLocation, Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport actions from '../../../helpers/actions';\nimport Tooltip from 'react-tooltip';\nimport Cookies from 'universal-cookie';\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    shop : state.shop.session\n});\n\nconst mapDispatchToProps = dispatch => ({\n    setCartItems : (items) => dispatch({\n        type    : actions.SET_CART_ITEMS,\n        payload : items\n    }),\n    initCart : (cartId) => dispatch({\n        type    : actions.INIT_CART,\n        payload : cartId\n    })\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction OrderSnapshot(props) {\n\n    // oneshop instance\n    const OS = new Oneshop();\n    // get passed props\n    let order = (useLocation() || {}).state || null;\n    // get cart items\n    let { shop } = props;\n    // get shop currency\n    const currency = (shop.currency || \"hkd\").toUpperCase();\n\n    // ---------------- LIFECYCLE ----------------\n    useEffect(() => {\n        // if order exists, reset cart\n        if(order != null) resetCart();\n    }, []);\n    // ---------------- /LIFECYCLE ----------------\n\n\n    // ------------- HELPER -------------\n    function extractThumbnail(item){\n        let thumbnail_url = \"https://via.placeholder.com/150\";\n        if((item.media || []).length > 0) thumbnail_url = item.media[0];\n        return thumbnail_url;\n    }\n\n    async function resetCart(){\n        try {\n            // retrieve cart id\n            let cartId = (await OS.cart.create()).rows[0].id;\n            // setup cookies\n            const cookies = new Cookies();\n            // save cart id\n            cookies.set('cartId', cartId, { samesite : 'none', secure : true });\n            // save to state\n            props.initCart(cartId);\n            // reset cart items\n            props.setCartItems([]);\n        } catch(error) {\n            // retry\n            resetCart();\n        }\n    }\n    // ------------- HELPER -------------\n\n    return order != null ? <div className=\"order-snapshot\">\n        <div className=\"order-snapshot-wrapper\">\n            <div className=\"content\">\n                <h1>Thank You!</h1>\n                <div className=\"order-id\">\n                    <b>Order #{order.id}</b>\n                </div>\n                <div className=\"order-detail\">\n                    <div className=\"order-detail-row\">\n                        <div className=\"icon\">\n                            <i className=\"fas fa-male\"></i>    \n                        </div> \n                        {order.contact.first_name} {order.contact.last_name}\n                    </div>\n                    <div className=\"order-detail-row\">\n                        <div className=\"icon\">\n                            <i className=\"fas fa-envelope\"></i> \n                        </div>\n                        {order.contact.email}\n                    </div>\n                    <div className=\"order-detail-row\">\n                        <div className=\"icon\">\n                            <i className=\"fas fa-phone\"></i>\n                        </div>\n                        {order.contact.phone}\n                    </div>\n                    <div className=\"order-detail-row\">\n                        <div className=\"icon\">\n                            <i className=\"fas fa-map-marker-alt\"></i>\n                        </div>\n                        {order.shipping.address}\n                    </div>\n                    <div className=\"order-detail-row\">\n                        <div className=\"icon\">\n                            <i className=\"fas fa-sticky-note\"></i>\n                        </div>\n                        {order.notes || \"---\"}\n                    </div>\n                </div>\n                <div className=\"items\">\n                    {(order.items || []).map(item => (<div key={`order-snapshot-item-${item.id}`} className=\"item\">\n                        <div className=\"thumbnail\">\n                            <img src={extractThumbnail(item)} alt={`image of ${item.name}`}/>\n                        </div>\n                        <div className=\"info\">\n                            <div className=\"name\">\n                                {item.name}\n                            </div>\n                            <div className=\"description\">\n                                {item.variant}\n                            </div>\n                        </div>\n                        <div className=\"unit-price\">\n                            {currency} {item.price.toFixed(2)} <i className=\"fas fa-times\"></i>\n                        </div>\n                        <div className=\"qty\">\n                            {item.qty}\n                        </div>\n                        <div className=\"subtotal\">\n                            {currency} {(item.price * item.qty).toFixed(2)}\n                        </div>\n                    </div>))}\n                </div>\n                <div className=\"order-summary\">\n                    <div className=\"subtotal\">\n                        Subtotal: {currency} {order.sub_total.toFixed(2)}\n                    </div>\n                    {\n                        (((order.breakdowns || [])[0] || {}).discounts || []).length > 0 ?\n                        <div className=\"discount\">\n                            <i data-tip={`${order.breakdowns[0].discounts.map((d, idx) => `${idx+1}. <b>${d.title}</b> -${currency}${d.amount}`).join(\"<br/>\")}`} className=\"fas fa-info-circle\"></i> Discount: {currency} {order.discounted_amount.toFixed(2)}\n                            <Tooltip type=\"dark\" html={true} />\n                        </div> : null\n                    }\n                    <div className=\"total\">\n                        Total: {currency} {order.gross_total.toFixed(2)}\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div> : <Redirect to=\"/products\" />;\n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrderSnapshot);\n\n","import React, { useEffect, useState } from 'react';\nimport './page.css';\nimport { connect } from 'react-redux';\nimport parser from 'html-react-parser';\nimport { useParams } from 'react-router-dom';\n\n\n// ------------------------ REDUX ------------------------\nconst mapStateToProps = state => ({\n    shop : state.shop.session\n});\n// ------------------------ /REDUX ------------------------\n\n\nfunction Page(){\n\n    // get filename\n    let fileName = useParams().file;\n    // text\n    let [text, setText] = useState(\"\");\n\n    // ----------------------- HELPERS -----------------------\n    useEffect(() => {\n        // load text file\n        fetchFile(fileName);\n    })\n\n    async function fetchFile(file){\n        try {\n            let text = await fetch(`/assets/text_files/${file}.txt`);\n            text = await text.text();\n            setText(text);\n        } catch (error) {\n            setText(`Failed to load ${file}.txt.`);\n        }\n    }\n    // ----------------------- /HELPERS -----------------------\n\n\n    return (\n        <div className=\"page\">\n            <div className=\"content\">\n                {parser(text)}\n            </div>\n        </div>\n    );\n}\n\nexport default connect(mapStateToProps)(Page);","import React, { useState, useEffect } from 'react';\nimport ws from '../../helpers/websocket';\nimport { connect } from 'react-redux';\n\n\n//  ------------ REDUX --------------\nconst mapStateToProps = state => ({\n    shop  : state.shop.session,\n    __    : state.i18n.__,\n});\n//  ------------ REDUX --------------\n\n\nconst ChatRow = (props) => {\n\n    // get message content\n    let { id, message, file, attachments, created_time, sender, previousItem, nextItem, shop, status, index, msgStatusDidChangeAtRowIndex, __ } = props;\n    // place to left?\n    let placeToLeft = !/^enquirer$/i.test(sender.type);\n    // padding top\n    let paddingTop = sender.type != (((previousItem || {}).sender || {}).type || \"\") ? \"7.5px\" : \"1px\";\n    let paddingBottom = sender.type != (((nextItem || {}).sender || {}).type || \"\") ? \"7.5px\" : \"1px\";\n    // set attachments\n    let [attachment] = useState((attachments || [])[0] || null);\n    // client alias\n    let [client, setClient] = useState(props.client || null);\n    // upload progress\n    let [percentage, setPercentage] = useState(0);\n\n\n    // ----------------- LIFECYCLE --------------------\n    useEffect(() => {\n        // pending msg\n        if(/^PENDING$/i.test(status)){\n            // file exists?\n            if(file != undefined){\n                // upload image first\n                uploadAttachment();\n            } else {\n                // send message directly\n                sendMessage();\n            }   \n        }\n    }, []);\n    // ----------------- /LIFECYCLE --------------------\n\n\n\n    // ------------------- send Messages -------------------\n    const connect = (cb) => {\n        ws.getClient(c => {\n            // save client\n            setClient(c);\n            // callback?\n            cb && cb(c);\n        });\n    }\n\n    const sendMessage = (media) => {\n        // send message\n        const get = (c) => { \n            // prepare payload\n            let payload = {  content : (message || \"\").trim().length > 0 ? message : \" \" };\n            // append media\n            if(media != undefined && (media || \"\").startsWith(\"https://\")) payload.attachments = [media];\n            // send cmd\n            c\n            .setAction('/leave.shop.message')\n            .setArguments({ shopId : shop.id })\n            .setForm(payload)\n            .cmd(sendMessageHandler) \n        };\n        // has client?\n        !client ? connect(get) : get(client);\n    }\n\n    // handler\n    const sendMessageHandler = result => {\n        // got profile?\n        if(result.result) {\n            msgStatusDidChangeAtRowIndex(\n                index, \n                { \n                    id     : ((result.data || {}).rows || []).id || id,\n                    status : 'SENT' \n                }\n            );\n        }\n    }\n    // ------------------- /send Messages -------------------\n\n\n\n\n\n    // --------------------- ATTACHMENT -----------------------\n    const uploadAttachment = () => {\n        // send message\n        client\n        .setAction(\"/signatures\")\n        .setForm({ extension : file.type })\n        .cmd(signatureHandler);\n    }\n\n    const signatureHandler = (result) => {\n        // success\n        if(result.result === true && ((result.data || {}).rows || []).length > 0) {\n            // use signature to upload photo\n            uploadPhoto(result.data.rows[0]);\n        } else {\n            // failed to get signature\n\n        }\n    }\n\n    const uploadPhoto = (signature) => {\n        // init form body\n      let body = new FormData();\n      // append data\n      body.append(\"key\", signature.fileName);\n      body.append(\"acl\", signature.bucketAcl);\n      body.append(\"Content-Type\", signature.mimeType);\n      body.append(\"X-Amz-Credential\", signature.amzCred);\n      body.append(\"X-Amz-Date\", signature.expDate);\n      body.append(\"Policy\", signature.encodedPolicy);\n      body.append(\"X-Amz-Signature\", signature.sign);\n      body.append(\"X-Amz-Algorithm\", \"AWS4-HMAC-SHA256\");\n      body.append(\"file\", file);\n      // create xhr request\n      let xhr = new XMLHttpRequest();\n      // set request\n      xhr.open( \"POST\", 'https://s3-ap-southeast-1.amazonaws.com/cdn.oneshop.cloud');\n      // on upload\n      xhr.upload.onprogress = ({ total, loaded }) => setPercentage((loaded/total)*100);\n      // error\n      xhr.onerror = (error) => {};\n      // done\n      xhr.onload = () => sendMessage(signature.endPoint);\n      // start\n      xhr.send(body);\n    }\n    // --------------------- ATTACHMENT -----------------------\n\n\n\n\n\n\n\n\n\n\n\n    return (\n        <div>\n            <div \n                className=\"cl-message-row\"\n                style={{\n                    justifyContent : placeToLeft ? 'flex-start' : 'flex-end',\n                    paddingTop,\n                    paddingBottom\n                }}\n            >\n                <div \n                    className=\"cl-message-bubble\" \n                    style={{\n                        backgroundImage : placeToLeft ? \"linear-gradient(-270deg, #efefef, #f8f8f8)\" : \"linear-gradient(-270deg, #0377fc, #3b96ff)\",\n                        color : placeToLeft ? 'black' : 'white',\n                    }}\n                >   \n                    {\n                        // -------------------------- ATTACHMENT --------------------------\n                        attachment != null && attachment != undefined ? \n                        <a href={attachment} target=\"_blank\">\n                            <img src={attachment} className=\"msg-media\" alt={attachment}/>\n                        </a>\n                        :\n                        null\n                    }\n                    {\n                        // -------------------------- MESSAGE --------------------------\n                        (message || \"\").trim().length > 0 ?\n                        <div className=\"msg-body\">{message}</div> : null\n                    }\n                    <div className=\"msg-timestamp\">\n                        {/^PENDING$/i.test(status) ? __(\"SENDING\") : toAmPm(created_time)}\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n\n\n\n// ----------------- Helper -----------------\nconst toAmPm = (timestring) => {\n    // get time\n    const time = new Date(timestring);\n    // get hour\n    let hh = time.getHours();\n    let h = hh;\n    // AM/PM ?\n    const M = hh != 24 && hh >= 12 ? \"PM\" : \"AM\";\n    // pad 0 to hr\n    if (h >= 12) {\n        h = hh - 12;\n    }\n    if (h == 0) {\n        h = 12;\n    }\n    // minutes\n    let min = time.getMinutes();\n    // pad 0 to min\n    min = min < 10 ? `0${min}` : min;\n    // return time only\n    return `${h}:${min} ${M}`;\n}\n// ----------------- /Helper -----------------\n\n\n\nexport default connect(mapStateToProps)(ChatRow);","import React, { useState, useEffect } from 'react';\nimport MessageRow from './chatRow';\nimport './chat.css';\nimport { connect } from 'react-redux';\nimport ws from '../../helpers/websocket';\nimport { isMobile } from 'react-device-detect';\n\n//  ------------ REDUX --------------\nconst mapStateToProps = state => ({\n    shop          : state.shop.session,\n    settings      : state.shop.settings,\n    i18n          : state.i18n,\n    globalProfile : state.user.profile\n});\n//  ------------ REDUX --------------\n\n\nconst Chat = (props) => {\n\n    // get shop\n    let { shop, globalProfile } = props;\n    // get i18n settings\n    let { __ } = props.i18n;\n    // display chat box\n    let [showChatBox, setShowChatBox] = useState(false);\n    // save client ref\n    let [client, setClient] = useState(null);\n    // profile for chating session\n    let [profile, setProfile] = useState(null);\n    // get messages\n    let [messages, setMessages] = useState([]);\n    // input valve\n    let [inputVal, setInputVal] = useState(\"\");\n    // attachment?\n    let [attachment, setAttachment] = useState(null);\n    // thumbnail\n    let [thumbnail, setThumbnail] = useState(null);\n\n    useEffect(() => {\n        // profile from http exists but ws's not exists\n        if(globalProfile && !profile) getProfile();\n        // get messages\n        if(client && profile && !messages.length) getMessages();\n    }, [globalProfile, profile, client]);\n\n    const connect = (cb) => {\n        ws.getClient(c => {\n            // save client\n            setClient(c);\n            // register\n            c.registerBroadCastListener(\"web_chat\", onBroadcast);\n            // callback?\n            cb && cb(c);\n        });\n    }\n\n    const scrollToEnd = () => {\n        // get element\n        let msgsList = document.getElementById(\"messages\");\n        msgsList.scrollTop = msgsList.scrollHeight;\n    }\n\n\n    // -------------------- broadcast listener --------------------\n    const onBroadcast = (broadcast) => {\n        // new message from merchant\n        if(/^shop\\.to\\.consumer$/i.test(broadcast.type || \"\") && broadcast.context != undefined){\n            // get msg context\n            let { id, message, attachments, sender, created_time, shop_id } = broadcast.context;\n            // from the same shop?\n            if(shop.id == shop_id) {\n                // push new incoming messages\n                setMessages(oldMsgs => [...oldMsgs].concat({\n                    id, message, sender, created_time, attachments, status : 'SENT'\n                }));\n                // scroll to the end\n                scrollToEnd();\n            }\n        }\n    }\n    // ---------------- /broadcast listener --------------------\n\n\n    // ------------------ Message did chnage listener ------------------\n    const msgStatusDidChangeAtRowIndex = (index, { id, status }) => {\n        // update message\n        setMessages([...messages].map((m, idx) => {\n            // id exists?\n            if(idx == index && id != undefined) m.id = id;\n            // status exists?\n            if(idx == index && status != undefined) m.status = status;\n            // return manipulated message obj\n            return m;\n        }));\n        // scroll to the end\n        scrollToEnd();\n    }\n    // ------------------ /Message did chnage listener ------------------\n\n\n    // ------------------- Get profile -------------------\n    const getProfile = () => {\n        // get profile\n        const get = (c) => { c.setAction('/my.profile').cmd(getProfileHandler) };\n        // has client?\n        !client ? connect(get) : get(client);\n    }\n\n    // handler\n    const getProfileHandler = result => {\n        // got profile?\n        if(result.result) setProfile(result.data.rows[0]);\n    }\n    // ------------------- /Get profile -------------------\n\n\n\n    // ------------------- Send Messages -------------------\n    const sendMessage = () => {\n        // clear msg and attachments\n        setInputVal(\"\");\n        setAttachment(null);\n        setThumbnail(null);\n        // push into msg container\n        setMessages(oldMsgs => {\n            let newMsgs = [...oldMsgs];\n            newMsgs.push({\n                id           : ws.uuid(),\n                message      : (inputVal || \"\"),\n                attachments  : thumbnail ? [`${thumbnail}`] : undefined,\n                file         : attachment || undefined,\n                created_time : new Date().toISOString(),\n                sender : {\n                    type : \"enquirer\" // me\n                },\n                status : 'PENDING'\n            });\n            return newMsgs;\n        });\n        // scroll to the end\n        scrollToEnd();\n    }\n    // ------------------- /Send Messages -------------------\n\n\n\n    // ------------------- Get Messages -------------------\n    const getMessages = () => {\n        // get profile\n        const get = (c) => { \n            c\n            .setAction('/get.shop.messages')\n            .setArguments({ \n                shopId : shop.id, \n                page   : Math.ceil(messages.length/15) + 1 \n            })\n            .cmd(getMessagesHandler) \n        };\n        // has client?\n        !client ? connect(get) : get(client);\n    }\n\n    // handler\n    const getMessagesHandler = result => {\n        // got profile?\n        if(result.result && ((result.data || {}).rows || []).length > 0) {\n            // save messages\n            setMessages(\n                [...messages]\n                .concat(result.data.rows)\n                .map(m => {\n                    // mark status as SENT if the msg is from server\n                    m.status = 'SENT';\n                    return m;\n                })\n            );\n            // scroll to the end\n            scrollToEnd();\n        }\n    }\n    // ------------------- /Get Messages -------------------\n\n\n\n    let valid = (inputVal || \"\").trim().length > 0 || attachment;\n\n\n    return (\n        <div className=\"chat-wrapper\">\n            {/* ----- Chat button ----- */}\n            <button className=\"chat-button\" onClick={() => setShowChatBox(!showChatBox)}>\n                {showChatBox ? <i className=\"fas fa-times\"></i> : <i className=\"fas fa-comment\"></i>} \n            </button>\n            {/* ----- /Chat button ----- */}\n            <div \n                className=\"chat-box\" \n                style={\n                    // show chat box\n                    showChatBox ? \n                    { \n                        width : (\n                            isMobile ? \n                            // mobile device\n                            window.innerWidth : // full screen\n                            // desktop\n                            (\n                                window.innerWidth/4 < 350 ? // smaller than 350px?\n                                350 : // min-width : 350px OR\n                                window.innerWidth/4  // screen width/4\n                            )\n                        ) - 50, \n                        height : (\n                            isMobile ? \n                            window.innerHeight : \n                            (\n                                window.innerHeight*2/3 < 500 ?\n                                500 : \n                                window.innerHeight*2/3\n                            )\n                        ) - 115, \n                        borderRadius : \"10px\", \n                        zIndex : 99999 \n                    } \n                    :  // hide it\n                    { width : \"48px\", height : \"48px\", borderRadius : \"24px\", zIndex : -1, borderColor : 'white' }\n                }\n            >\n                {\n                    profile == null ?\n                    // ----------------- Disconnected -----------------\n                    <div className=\"chat-box-placeholder\">\n                        <i className=\"fas fa-unlink\"></i>\n                        <span>\n                            {__(\"Disconnected\")}\n                        </span>\n                        <span>\n                            {__(\"Please login again.\")}\n                        </span>\n                        <button onClick={() => setShowChatBox(false)}>\n                            {__(\"Close\")}\n                        </button>\n                    </div> :\n                    // ----------------- Logged in, chatlist -----------------\n                    <div className=\"chat-list\">\n                        <div className=\"cl-header\">\n                            <div style={{flex:1}}>{shop.name}</div>\n                            <button onClick={() => setShowChatBox(false)}>\n                                <i className=\"fas fa-times\"></i>\n                            </button>\n                        </div>\n                        <div id=\"messages\" className=\"cl-messages\">\n                            {messages\n                            .filter((m, i, ms) => {\n                                let mids = ms.map(m => m.id);\n                                return mids.indexOf(m.id) === i;\n                            })\n                            .sort((a, b) => new Date(a.created_time).getTime() - new Date(b.created_time).getTime())\n                            .map((m, i, arr) => <MessageRow \n                                                {...m} \n                                                key={`msg_row_${i}`}\n                                                client={client} \n                                                previousItem={arr[i-1]} \n                                                nextItem={arr[i+1]}\n                                                index={i}\n                                                msgStatusDidChangeAtRowIndex={msgStatusDidChangeAtRowIndex}\n                                            />)}\n                        </div>\n                        {\n                            thumbnail ? \n                            <div className=\"cl-attachment-view\">\n                                {/* ------- thumbnail image ------- */}\n                                <img src={thumbnail} />\n                                {/* ------- remove button -------- */}\n                                <button onClick={() => {\n                                    // clear attachment and thumbnail\n                                    setAttachment(null);\n                                    setThumbnail(null);\n                                }}>\n                                    <i className=\"fas fa-trash\"></i>\n                                </button>\n                            </div> : null\n                        }\n                        \n                        <div className=\"cl-input-wrapper\">\n                            {\n                                // show attachment button only on desktop\n                                !isMobile ?\n                                <button \n                                    className=\"attachment-button\"\n                                    onClick={() => {\n                                        document.getElementById('fileButton').click();\n                                    }}\n                                    disabled={attachment != null}\n                                >\n                                    <input \n                                        id=\"fileButton\" \n                                        type=\"file\" \n                                        hidden \n                                        accept=\".png,.jpeg\"\n                                        onChange={e => {\n                                        // get file\n                                        let file = e.target.files[0];\n                                        // file exists?\n                                        if(file) {\n                                            //create reader\n                                            let reader = new FileReader();\n                                            // on read\n                                            reader.onload = e => {\n                                                // save attachment file\n                                                setAttachment(file);    \n                                                // set thumbnail\n                                                setThumbnail(e.target.result)\n                                            }\n                                            // start read file\n                                            reader.readAsDataURL(file);\n                                        }\n                                    }}/>\n                                    <i className=\"fas fa-image\"></i>\n                                </button> : null\n                            }\n                            <input \n                                type=\"text\"\n                                value={inputVal}\n                                onChange={e => setInputVal(e.target.value)}\n                                onKeyUp={e => {\n                                    // press enter and valid to send?\n                                    if((/^enter$/i.test(e.key) || e.keyCode === 13) && valid){\n                                        // send\n                                        sendMessage();\n                                    }\n                                }}\n                                placeholder={__(\"Press Enter to send\")}\n                            />\n                            <button \n                                className=\"send-button\"\n                                onClick={sendMessage}\n                                disabled={!valid}\n                            >\n                                <i className=\"fas fa-paper-plane\"></i>\n                            </button>\n                        </div>\n                    </div>\n                }\n            </div>\n        </div>\n    )\n\n}\n\nexport default connect(mapStateToProps)(Chat);","import React from 'react';\nimport { Route, Switch, withRouter, Redirect} from 'react-router-dom';\nimport './routes.css';\n\nimport NavBar from '../../components/NavBar';\nimport Footer from '../../components/Footer';\nimport Home from '../Home';\nimport Product from '../Product';\nimport ProductDetail from '../Product/Detail';\nimport Blog from '../Blog';\nimport BlogDetail from '../Blog/Detail';\nimport NotFound from '../404';\nimport Checkout from '../Checkout';\nimport User from '../User';\nimport Register from '../User/Register';\nimport Login from '../User/Login';\nimport AccountRecovery from '../User/Recovery';\nimport Cart from '../Cart';\nimport OrderSnapshot from '../Checkout/OrderSnapshot';\nimport Page from '../Page';\nimport Chat from '../../components/Chat';\n\nfunction Routes(){\n\n    return (\n        <div className=\"wrapper\">\n            <NavBar/>\n            <div className=\"scene\">\n                <Switch>\n                    <Route path=\"/\" component={Home} exact />\n                    <Route path=\"/products\" component={Product} exact />\n                    <Route path=\"/products/:id\" component={ProductDetail} exact />\n                    <Route path=\"/blogs\" component={Blog} exact />\n                    <Route path=\"/blogs/:id\" component={BlogDetail} exact />\n                    <Route path=\"/pages/:file\" component={Page} exact />\n                    <Route path=\"/users\" component={User} exact/>\n                    <Route path=\"/users/new\" component={Register} exact/>\n                    <Route path=\"/users/login\" component={Login} exact/>\n                    <Route path=\"/users/account_rescue\" component={AccountRecovery} exact/>\n                    <Redirect from=\"/login\" to=\"/users/login\" exact/>\n                    <Route path=\"/checkout\" component={Checkout} exact />\n                    <Route path=\"/checkout/success\" component={OrderSnapshot} exact/>\n                    <Route path=\"/cart\" component={Cart} exact />\n                    <Route component={NotFound} />\n                </Switch>\n            </div>\n            <Chat />\n            <Footer/>\n        </div>\n    )\n}\n\nexport default withRouter(Routes);","import React, { useEffect } from 'react';\nimport {BrowserRouter} from 'react-router-dom';\nimport Routes from '../Routes';\nimport { connect } from 'react-redux';\nimport actions from '../../helpers/actions';\nimport oneshop from 'oneshop.web';\nimport { MoonLoader } from 'react-spinners';\nimport Cookies from 'universal-cookie';\n\nconst mapStateToProps = (state, ownProps) => ({\n    shop    : state.shop.session,\n    cart    : state.cart,\n    profile : state.user.profile\n});\n\nconst mapDispatchToProps = (dispatch, ownProps) => ({\n    setShop : (shop) => dispatch({\n        type    : actions.SET_SHOP,\n        payload : shop\n    }),\n    initCart : (cartId) => dispatch({\n        type    : actions.INIT_CART,\n        payload : cartId\n    }),\n    setCartItems : (items) => dispatch({\n        type    : actions.SET_CART_ITEMS,\n        payload : items\n    }),\n    setProfile : profile => dispatch({\n        type    : actions.SET_USER,\n        payload : profile\n    })\n});\n\nfunction App(props){\n\n    // create oneshop instance\n    const OS = new oneshop();\n    // setup cookies\n    const cookies = new Cookies();\n    // get props\n    const { shop, cart, profile } = props;\n    \n    // ---------------- LIFECYCLE ----------------\n    useEffect(() => {\n        // shop not loaded yet\n        if(!shop){\n            // set get shop handler\n            (function getShop(){\n                OS.shop.settings()\n                // get shop settings\n                .then(rows => {\n                    // get shop\n                    props.setShop(rows[0]);\n                })\n                .catch(error => {\n                    // try again\n                    getShop();\n                });\n            })();\n        }\n        // load cart items if cart exists\n        !cart.id ? setupCart() : validateCart();\n        // profile not exists?\n        if(!profile) getProfile();\n    }, []);\n    // ---------------- /LIFECYCLE ----------------\n\n\n    // ---------------- HELPERS ----------------\n    async function setupCart(){\n        try {\n            // retrieve cart id\n            let cartId = (await OS.cart.create()).rows[0].id;\n            // save cart id\n            cookies.set('cartId', cartId, { samesite : 'None', secure : true });\n            // save to state\n            props.initCart(cartId);\n        } catch(error) {\n            // retry\n            setupCart();\n        }\n    }\n\n    async function validateCart(){\n        try {\n            // try to get items\n            let cart_items = await OS.cart.item.get(cart.id);    \n            // save cart items\n            props.setCartItems(cart_items);\n        } catch (error) {\n            // cart not valid, setup\n            setupCart();\n        }\n    }\n\n    async function getProfile(){\n        try {\n            // try to get items\n            let profile = await OS.consumer.profile.get();\n            // save profile\n            props.setProfile(profile[0]);\n        } catch (error) {}\n    }\n    // ---------------- /HELPERS ----------------\n\n    return (\n        // shop and cart not loaded yet?\n        shop == null || cart.id == null? \n        // show loader\n        <div style={{ width:\"100%\", height:\"100vh\", display:\"flex\", justifyContent: \"center\", \"alignItems\":\"center\" }}>\n            <MoonLoader \n                size={30}\n                color={\"#000000\"}\n                loading={true}\n            /> \n        </div>\n        :\n        // show web\n        <BrowserRouter>\n            <Routes/>\n        </BrowserRouter>\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","let initState = {\n    products : [],\n    best_sellers : []\n};\n\nexport default (state = initState, action) => {\n    switch(action.type) {\n        case 'SET_PRODUCTS' :\n            return {\n                ...state,\n                products : action.payload\n            };\n        case 'ADD_BEST_SELLERS' :\n            return {\n                ...state,\n                best_sellers : action.payload\n            };\n        default:\n            return state;\n    }\n}","let initState = {\n    articles : []\n};\n\nexport default (state = initState, action) => {\n    switch(action.type) {\n        case 'SET_ARTICLES' :\n            return {\n                ...state,\n                articles : action.payload\n            };\n        default:\n            return state;\n    }\n}","let initState = {\n    profile : null\n};\n\nexport default (state = initState, action) => {\n    switch(action.type) {\n        case 'SET_USER' :\n            return {\n                profile : action.payload\n            };\n        default:\n            return state;\n    }\n}","import OS_Config from '../../config';\n\nlet initState = {\n    session            : null,\n    collections        : [],\n    selectedCollection : null\n};\n\nexport default (state = initState, action) => {\n    switch(action.type) {\n        case 'SET_SHOP' : {\n            // preset home page layout\n            let home_page_layout = {}\n            // has home page layout settings?\n            if((action.payload.attributes || {}).home_page_layout != null) {\n                try {\n                    home_page_layout = JSON.parse(action.payload.attributes.home_page_layout)\n                } catch (error) {\n                    // do nothing when error occured\n                }   \n            }\n            return {\n                session  : action.payload,\n                settings : {\n                    ...OS_Config.settings,\n                    layout_override : home_page_layout\n                }\n            };\n        }\n        case 'SET_COLLECTIONS' : {\n            return {\n                ...state,\n                collections : action.payload\n            }\n        }\n        case 'SET_SELECTED_COLLECTION' : {\n            return {\n                ...state,\n                selectedCollection : action.payload\n            }\n        }\n        default:\n            return state;\n    }\n}","const Cookies = require('universal-cookie').default;\n// setup cookies\nconst cookies = new Cookies();\n\nlet initState = {\n    id : cookies.get('cartId') || null,\n    items : []\n};\n\nexport default (state = initState, action) => {\n    switch(action.type) {\n        case 'INIT_CART' : {\n            return {\n                ...state,\n                id : action.payload\n            };\n        }\n        case 'SET_CART_ITEMS' :\n            return {\n                ...state,\n                items : action.payload\n            };\n        default:\n            return state;\n    }\n}","let initState = {};\n\nexport default (state = initState, action) => {\n    switch(action.type) {\n        case 'SET_HOME_CONTEXT' :\n            return {\n                ...state,\n                [action.key] : action.payload\n            };\n        default:\n            return state;\n    }\n}","// load cookies library\nconst Cookies = require('universal-cookie').default;\n// setup cookies\nconst cookies = new Cookies();\n\n\nlet initState = {\n    locale  : cookies.get('os-locale') || 'en_US',\n    locales : [\n        {\n            name : \"English\",\n            code : \"en_US\"\n        },\n        {\n            name : \"繁體中文\",\n            code : \"zh_HK\"\n        }\n    ],\n    __      : function(key) {\n        // get locale\n        let locale = cookies.get('os-locale') || 'en_US';\n        // set wordings container\n        let wordings = {};\n        // try to process wordings json\n        try {\n            // get the text file\n            let raw = require(`../locales/${locale}.json`);\n            // save it\n            wordings = raw;\n        } catch (error) { /* do nothing */ }\n        // return translated text, if not exists, return the key by default\n        return wordings[key] == undefined ? key : wordings[key];\n    }\n};\n\n\nexport default (state = initState, action) => {\n    switch(action.type) {\n        case 'SET_LOCALE' : {\n            // save locale\n            cookies.set(\n                'os-locale', \n                action.payload, \n                { \n                    samesite : 'None', \n                    secure   : false, \n                    path     : \"/\" \n                }\n            );\n            // refresh\n            window.location.reload()\n            // return {\n            //     ...state,\n            //     locale : action.payload\n            // };\n        }\n        default:\n            return state;\n    }\n}","import { combineReducers } from 'redux';\nimport product from './product';\nimport article from './article';\nimport user from './user';\nimport shop from './shop';\nimport cart from './cart';\nimport home from './home';\nimport i18n from './i18n';\n\nexport default combineReducers({ product, article, user, shop, cart, home, i18n });","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './scenes/App';\nimport * as serviceWorker from './serviceWorker';\nimport { Provider } from 'react-redux';\nimport { createStore } from 'redux';\nimport reducer from './helpers/reducers';\n\nconst store = createStore(reducer);\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>, \n    document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = {\n    // Shop settings goes here\n    settings : {\n        layout : {\n            // nav-bar settings\n            navBar : {\n                display : {\n                    blog : true,\n                    shop : true,\n                    user : true\n                }\n            },\n            // Key - widget name\n            content : [\n                /**\n                 *  Banner (articles)\n                 */\n                {\n                    widget : \"Banner\", // type is required\n                    // filters\n                    tags : \"\",\n                    ordering : \"\",\n                    numberToShow : 1,\n                    ids : \"\",\n                    collections : \"\",\n                    // silder settings\n                    duration : 5000,\n                    transitionDuration : 300,\n                    infinite : true,\n                    indicators : false,\n                    arrows : false,\n                    // styles to override\n                    styles : {\n                        height : 630\n                    }\n                },\n\n                /** Best Seller */\n                {\n                    widget : \"CollectionProduct\", // type is required\n                    tags : \"bestseller\",\n                    // title\n                    title : \"Best Seller\",\n                    type : \"sale\",\n                    rows : 1,\n                    cols : 4,\n                    // styles to override\n                    styles : {\n                    }\n                },\n\n                /** Featured */\n                {\n                    widget : \"CollectionProduct\", // type is required\n                    tags : \"featured\",\n                    // title\n                    title : \"Featured\",\n                    type : \"sale\",\n                    rows : 1,\n                    cols : 4,\n                    // styles to override\n                    styles : {\n                    }\n                },\n\n\n                /** */\n                {\n                    widget : \"Seperator\",\n                    styles : {\n                        margin : \"50px 0px 60px 0px\",\n                        height : \"0.5px\"\n                    }\n                },\n\n                /** Article Tile */\n                {\n                    widget : \"ArticleTile\", // type is required\n                    // filters\n                    tags : \"\",\n                    ordering : \"\",\n                    ids : \"\",\n                    rows : 1,\n                    cols : 4,\n                    collections : \"\",\n                    // title\n                    title : \"Sharing\",\n                    type : \"sale\",\n                    // styles to override\n                    styles : {\n                    }\n                },\n\n\n                /** Products */\n                {\n                    widget : \"Product\", // type is required\n                    // filters\n                    tags : \"\",\n                    ordering : \"\",\n                    ids : \"\",\n                    rows : 1,\n                    cols : 6,\n                    collection_tags : \"50\",\n                    // title\n                    title : \"Latest Products\",\n                    type : \"sale\",\n                    // styles to override\n                    styles : {\n                    }\n                },\n\n                /**  Seperator */\n                /*\n                {\n                    widget : \"Seperator\",\n                    styles : {\n                        margin : \"10px 0px\"\n                    }\n                }\n                */\n            ]            \n        },\n        links : {\n            policies : {\n                shipping_policy      : \"shipping_policy\", // the file name id of your shipping policy (path: /public/assets/text_files)\n                privacy_policy       : \"privacy_policy\", // the file name id of your privacy policy (path: /public/assets/text_files)\n                terms_and_conditions : \"terms_and_conditions\"  // the file name id of your terms and condition (path: /public/assets/text_files)\n            },\n            social : {\n                facebook : \"https://facebook.com\",\n                instagram : \"https://instagram.com\",\n                youtube : \"https://youtube.com\",\n                twitter : \"https://twitter.com\",\n                pinterest : \"https://pinterest.com\"\n            }\n        }\n    }\n};"],"sourceRoot":""}